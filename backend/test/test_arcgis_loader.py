import copy
import datetime
import json

import psycopg2
import pytest
import requests
from requests_mock import ANY
from shapely.geometry import Point

from backend.lambda_functions.arcgis_loader.arcgis_loader import ArcGisLoader
from backend.lambda_functions.base_loader.base_loader import DatabaseHelper

kulttuuriymparisto_service_response = {
    "currentVersion": 10.6,
    "serviceDescription": "",
    "mapName": "Layers",
    "description": "",
    "copyrightText": "Museovirasto",
    "supportsDynamicLayers": False,
    "layers": [
        {
            "id": 1,
            "name": "Muinaisjaannokset_piste",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 0,
            "maxScale": 0,
        },
        {
            "id": 3,
            "name": "Muinaisjaannokset_alue",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 0,
            "maxScale": 0,
        },
        {
            "id": 6,
            "name": "RKY_alue",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 0,
            "maxScale": 0,
        },
        {
            "id": 7,
            "name": "RKY_piste",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 0,
            "maxScale": 0,
        },
    ],
    "tables": [],
    "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    "singleFusedMapCache": False,
    "initialExtent": {
        "xmin": 547219.2128453464,
        "ymin": 7585727.946598293,
        "xmax": 572666.8887406983,
        "ymax": 7601491.853126107,
        "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    },
    "fullExtent": {
        "xmin": 91095.35819999967,
        "ymin": 6620936.237299999,
        "xmax": 732593.5810000002,
        "ymax": 7774461.389699999,
        "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    },
    "minScale": 0,
    "maxScale": 0,
    "units": "esriMeters",
    "supportedImageFormatTypes": "PNG32,PNG24,PNG,JPG,DIB,TIFF,EMF,PS,PDF,GIF,SVG,SVGZ,BMP",
    "documentInfo": {
        "Title": "",
        "Author": "",
        "Comments": "",
        "Subject": "Museoviraston WFS-rajapinta, Suunnittelija",
        "Category": "",
        "AntialiasingMode": "None",
        "TextAntialiasingMode": "Force",
        "Keywords": "WFS,suojellut",
    },
    "capabilities": "Map,Query,Data",
    "supportedQueryFormats": "JSON, AMF, geoJSON",
    "exportTilesAllowed": False,
    "supportsDatumTransformation": True,
    "maxRecordCount": 10000,
    "maxImageHeight": 4096,
    "maxImageWidth": 4096,
    "supportedExtensions": "WFSServer",
}

muinaisjaannokset_query_response = {
    "displayFieldName": "inspireID",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "mjtunnus": "mjtunnus",
        "inspireID": "inspireID",
        "kohdenimi": "kohdenimi",
        "kunta": "kunta",
        "laji": "laji",
        "tyyppi": "tyyppi",
        "alatyyppi": "alatyyppi",
        "ajoitus": "ajoitus",
        "vedenalainen": "vedenalainen",
        "muutospvm": "muutospvm",
        "luontipvm": "luontipvm",
        "paikannustapa": "paikannustapa",
        "paikannustarkkuus": "paikannustarkkuus",
        "selite": "selite",
        "url": "url",
        "x": "x",
        "y": "y",
    },
    "geometryType": "esriGeometryPoint",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {"name": "mjtunnus", "type": "esriFieldTypeInteger", "alias": "mjtunnus"},
        {
            "name": "inspireID",
            "type": "esriFieldTypeString",
            "alias": "inspireID",
            "length": 70,
        },
        {
            "name": "kohdenimi",
            "type": "esriFieldTypeString",
            "alias": "kohdenimi",
            "length": 100,
        },
        {
            "name": "kunta",
            "type": "esriFieldTypeString",
            "alias": "kunta",
            "length": 100,
        },
        {"name": "laji", "type": "esriFieldTypeString", "alias": "laji", "length": 100},
        {
            "name": "tyyppi",
            "type": "esriFieldTypeString",
            "alias": "tyyppi",
            "length": 406,
        },
        {
            "name": "alatyyppi",
            "type": "esriFieldTypeString",
            "alias": "alatyyppi",
            "length": 406,
        },
        {
            "name": "ajoitus",
            "type": "esriFieldTypeString",
            "alias": "ajoitus",
            "length": 406,
        },
        {
            "name": "vedenalainen",
            "type": "esriFieldTypeString",
            "alias": "vedenalainen",
            "length": 1,
        },
        {
            "name": "muutospvm",
            "type": "esriFieldTypeDate",
            "alias": "muutospvm",
            "length": 8,
        },
        {
            "name": "luontipvm",
            "type": "esriFieldTypeDate",
            "alias": "luontipvm",
            "length": 8,
        },
        {
            "name": "paikannustapa",
            "type": "esriFieldTypeString",
            "alias": "paikannustapa",
            "length": 50,
        },
        {
            "name": "paikannustarkkuus",
            "type": "esriFieldTypeString",
            "alias": "paikannustarkkuus",
            "length": 50,
        },
        {
            "name": "selite",
            "type": "esriFieldTypeString",
            "alias": "selite",
            "length": 254,
        },
        {"name": "url", "type": "esriFieldTypeString", "alias": "url", "length": 38},
        {"name": "x", "type": "esriFieldTypeDouble", "alias": "x"},
        {"name": "y", "type": "esriFieldTypeDouble", "alias": "y"},
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 51540,
                "mjtunnus": 2133,
                "inspireID": "http://paikkatiedot.fi/so/1000272/ps/ProtectedSite/2133_P51540",
                "kohdenimi": "Särkänniemi 1                                                                                       ",
                "kunta": "Tampere                                                                                             ",
                "laji": "kiinteä muinaisjäännös                                                                              ",
                "tyyppi": "alusten hylyt,  ,  ,  ",
                "alatyyppi": "hylyt (puu),  ,  ,  ",
                "ajoitus": "historiallinen,  ,  ,  ",
                "vedenalainen": "K",
                "muutospvm": None,
                "luontipvm": 1390867200000,
                "paikannustapa": None,
                "paikannustarkkuus": None,
                "selite": "Piste on luotu automaattisesti tietokannan koordinaattien avulla",
                "url": "www.kyppi.fi/to.aspx?id=112.2133",
                "x": 326847,
                "y": 6823690,
            },
            "geometry": {"x": 23.745516826584094, "y": 61.507940865645104},
        },
    ],
}

rkykohteet_query_response = {
    "displayFieldName": "inspireID",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "ID": "ID",
        "inspireID": "inspireID",
        "kohdenimi": "kohdenimi",
        "url": "url",
    },
    "geometryType": "esriGeometryPoint",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {"name": "ID", "type": "esriFieldTypeInteger", "alias": "ID"},
        {
            "name": "inspireID",
            "type": "esriFieldTypeString",
            "alias": "inspireID",
            "length": 70,
        },
        {
            "name": "kohdenimi",
            "type": "esriFieldTypeString",
            "alias": "kohdenimi",
            "length": 85,
        },
        {"name": "url", "type": "esriFieldTypeString", "alias": "url", "length": 63},
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 45,
                "ID": 2218,
                "inspireID": "http://paikkatiedot.fi/so/1000034/ps/ProtectedSite/2218_P45",
                "kohdenimi": "Pyynikin näkötorni",
                "url": "http://www.rky.fi/read/asp/r_kohde_det.aspx?KOHDE_ID=2218",
            },
            "geometry": {"x": 23.731920589585563, "y": 61.49636537556975},
        },
    ],
}

suojellutalueet_service_response = {
    "currentVersion": 10.71,
    "serviceDescription": "Tämä palvelu sisältää seuraavat aineistot: luonnonsuojelualueet ja Natura-alueet.",
    "mapName": "Layers",
    "description": "",
    "copyrightText": "SYKE",
    "supportsDynamicLayers": True,
    "layers": [
        {
            "id": 0,
            "name": "Natura 2000",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": [1, 2, 3, 4],
            "minScale": 0,
            "maxScale": 0,
            "type": "Group Layer",
        },
        {
            "id": 1,
            "name": "Natura 2000 - SAC Manner-Suomi viivamaiset",
            "parentLayerId": 0,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 20000000,
            "maxScale": 1000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolyline",
        },
        {
            "id": 2,
            "name": "Natura 2000 - SAC Manner-Suomi aluemaiset",
            "parentLayerId": 0,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 10000000,
            "maxScale": 5000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
        {
            "id": 3,
            "name": "Natura 2000 - SPA Manner-Suomi",
            "parentLayerId": 0,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 10000000,
            "maxScale": 5000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
        {
            "id": 4,
            "name": "Natura 2000 - SCI Manner-Suomi",
            "parentLayerId": 0,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 10000000,
            "maxScale": 5000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
        {
            "id": 5,
            "name": "Luonnonsuojelu- ja erämaa-alueet",
            "parentLayerId": -1,
            "defaultVisibility": True,
            "subLayerIds": [6, 7, 8],
            "minScale": 0,
            "maxScale": 0,
            "type": "Group Layer",
        },
        {
            "id": 6,
            "name": "Yksityiset suojelualueet",
            "parentLayerId": 5,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 3000000,
            "maxScale": 1000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
        {
            "id": 7,
            "name": "Valtion maiden luonnonsuojelualueet",
            "parentLayerId": 5,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 3000000,
            "maxScale": 1000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
        {
            "id": 8,
            "name": "Erämaa-alueet",
            "parentLayerId": 5,
            "defaultVisibility": True,
            "subLayerIds": None,
            "minScale": 3000000,
            "maxScale": 1000,
            "type": "Feature Layer",
            "geometryType": "esriGeometryPolygon",
        },
    ],
    "tables": [],
    "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    "singleFusedMapCache": False,
    "initialExtent": {
        "xmin": 135022.2818301586,
        "ymin": 7382304.110044492,
        "xmax": 777961.0677077305,
        "ymax": 7683135.9617081955,
        "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    },
    "fullExtent": {
        "xmin": 84333.45399999991,
        "ymin": 6616098.198,
        "xmax": 732907.7249999996,
        "ymax": 7768899.149,
        "spatialReference": {"wkid": 102139, "latestWkid": 3067},
    },
    "minScale": 20000000,
    "maxScale": 1000,
    "units": "esriMeters",
    "supportedImageFormatTypes": "PNG32,PNG24,PNG,JPG,DIB,TIFF,EMF,PS,PDF,GIF,SVG,SVGZ,BMP",
    "documentInfo": {
        "Title": "",
        "Author": "",
        "Comments": "Tämä palvelu sisältää seuraavat aineistot: luonnonsuojelualueet ja Natura-alueet.",
        "Subject": "Tämä palvelu sisältää seuraavat aineistot: luonnonsuojelualueet ja Natura-alueet.",
        "Category": "",
        "AntialiasingMode": "None",
        "TextAntialiasingMode": "Force",
        "Keywords": "Suojellut alueet",
    },
    "capabilities": "Map,Query,Data",
    "supportedQueryFormats": "JSON, geoJSON",
    "exportTilesAllowed": False,
    "datumTransformations": [
        {
            "geoTransforms": [
                {
                    "wkid": 108229,
                    "latestWkid": 108229,
                    "transformForward": True,
                    "name": "KKJ_To_EUREF_FIN",
                }
            ]
        },
        {
            "geoTransforms": [
                {
                    "wkid": 108229,
                    "latestWkid": 108229,
                    "transformForward": False,
                    "name": "KKJ_To_EUREF_FIN",
                }
            ]
        },
    ],
    "supportsDatumTransformation": True,
    "maxRecordCount": 1000,
    "maxImageHeight": 4096,
    "maxImageWidth": 4096,
    "supportedExtensions": "WMSServer",
}

naturasac_query_response = {
    "displayFieldName": "naturaTunnus",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "naturaTunnus": "naturaTunnus",
        "suojeluPerusteTunnus": "suojeluPerusteTunnus",
        "versioTunnus": "versioTunnus",
        "nimiSuomi": "nimiSuomi",
        "nimiRuotsi": "nimiRuotsi",
        "alueTyyppi": "alueTyyppi",
        "tietolomakeURL": "tietolomakeURL",
        "paatosPvm": "paatosPvm",
        "paatosPAla_ha": "paatosPAla_ha",
        "paatosPituus_m": "paatosPituus_m",
        "meriPAlaProsentti": "meriPAlaProsentti",
        "paatosAsiakirja": "paatosAsiakirja",
        "ensisijLajiLuonto": "ensisijLajiLuonto",
        "alueJaViiva": "alueJaViiva",
        "VPDSuoj": "VPDSuoj",
        "lisatieto": "lisatieto",
        "luontiPvm": "luontiPvm",
        "muutosPvm": "muutosPvm",
        "paattymisPvm": "paattymisPvm",
        "SHAPE.STArea()": "SHAPE.STArea()",
        "SHAPE.STLength()": "SHAPE.STLength()",
    },
    "geometryType": "esriGeometryPolygon",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {
            "name": "naturaTunnus",
            "type": "esriFieldTypeString",
            "alias": "naturaTunnus",
            "length": 9,
        },
        {
            "name": "suojeluPerusteTunnus",
            "type": "esriFieldTypeString",
            "alias": "suojeluPerusteTunnus",
            "length": 15,
        },
        {
            "name": "versioTunnus",
            "type": "esriFieldTypeDate",
            "alias": "versioTunnus",
            "length": 8,
        },
        {
            "name": "nimiSuomi",
            "type": "esriFieldTypeString",
            "alias": "nimiSuomi",
            "length": 150,
        },
        {
            "name": "nimiRuotsi",
            "type": "esriFieldTypeString",
            "alias": "nimiRuotsi",
            "length": 150,
        },
        {
            "name": "alueTyyppi",
            "type": "esriFieldTypeString",
            "alias": "alueTyyppi",
            "length": 10,
        },
        {
            "name": "tietolomakeURL",
            "type": "esriFieldTypeString",
            "alias": "tietolomakeURL",
            "length": 1000,
        },
        {
            "name": "paatosPvm",
            "type": "esriFieldTypeDate",
            "alias": "paatosPvm",
            "length": 8,
        },
        {
            "name": "paatosPAla_ha",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPAla_ha",
        },
        {
            "name": "paatosPituus_m",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPituus_m",
        },
        {
            "name": "meriPAlaProsentti",
            "type": "esriFieldTypeDouble",
            "alias": "meriPAlaProsentti",
        },
        {
            "name": "paatosAsiakirja",
            "type": "esriFieldTypeString",
            "alias": "paatosAsiakirja",
            "length": 230,
        },
        {
            "name": "ensisijLajiLuonto",
            "type": "esriFieldTypeInteger",
            "alias": "ensisijLajiLuonto",
        },
        {"name": "alueJaViiva", "type": "esriFieldTypeInteger", "alias": "alueJaViiva"},
        {"name": "VPDSuoj", "type": "esriFieldTypeInteger", "alias": "VPDSuoj"},
        {
            "name": "lisatieto",
            "type": "esriFieldTypeString",
            "alias": "lisatieto",
            "length": 200,
        },
        {
            "name": "luontiPvm",
            "type": "esriFieldTypeDate",
            "alias": "luontiPvm",
            "length": 8,
        },
        {
            "name": "muutosPvm",
            "type": "esriFieldTypeDate",
            "alias": "muutosPvm",
            "length": 8,
        },
        {
            "name": "paattymisPvm",
            "type": "esriFieldTypeDate",
            "alias": "paattymisPvm",
            "length": 8,
        },
        {
            "name": "SHAPE.STArea()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STArea()",
        },
        {
            "name": "SHAPE.STLength()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STLength()",
        },
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 367,
                "naturaTunnus": "FI0341008",
                "suojeluPerusteTunnus": "SACFI0341008",
                "versioTunnus": 1473724800000,
                "nimiSuomi": "Siikaneva",
                "nimiRuotsi": "Siikaneva",
                "alueTyyppi": "SAC",
                "tietolomakeURL": None,
                "paatosPvm": 1427414400000,
                "paatosPAla_ha": 1300.0,
                "paatosPituus_m": 0.0,
                "meriPAlaProsentti": 0.0,
                "paatosAsiakirja": "http://www.finlex.fi/fi/laki/alkup/2015/20150354",
                "ensisijLajiLuonto": 1,
                "alueJaViiva": 0,
                "VPDSuoj": 0,
                "lisatieto": None,
                "luontiPvm": 1473724800000,
                "muutosPvm": None,
                "paattymisPvm": None,
                "SHAPE.STArea()": 12987536.68725586,
                "SHAPE.STLength()": 37791.09285790004,
            },
            "geometry": {
                "rings": [
                    [
                        [24.105315476389517, 61.82722809324754],
                        [24.105465928720665, 61.827231264184924],
                        [24.105591993415334, 61.827262990510675],
                        [24.10556974709466, 61.827793058194125],
                        [24.10547766535632, 61.8284123480923],
                        [24.105225706772472, 61.82897957069912],
                        [24.105454722502017, 61.8289487611309],
                        [24.105859284694684, 61.82892165037601],
                        [24.106491743384368, 61.82887557931786],
                        [24.107026107791956, 61.828803687761436],
                        [24.10713038922013, 61.82849702546148],
                        [24.107284820913765, 61.82819141936431],
                        [24.107326145574618, 61.827752762016196],
                        [24.10738023102197, 61.827445042362754],
                        [24.10750623859867, 61.82717447360709],
                        [24.10914910458566, 61.82705282866129],
                        [24.10965109895261, 61.82641717363913],
                        [24.110082625553524, 61.82610313993248],
                        [24.110696266012127, 61.82578875028684],
                        [24.11135722279384, 61.825710774394985],
                        [24.11162449650655, 61.82585941628339],
                        [24.111977728883268, 61.82584310231521],
                        [24.112333211445712, 61.82580305640298],
                        [24.112839101322212, 61.825766171592434],
                        [24.11352163313683, 61.825721130902316],
                        [24.1143830166583, 61.825644199817695],
                        [24.115038213206386, 61.82562233766829],
                        [24.113425206230172, 61.82701393226471],
                        [24.114549057025513, 61.82708507792315],
                        [24.116522759333073, 61.82713918701091],
                        [24.116987264885104, 61.82680367256617],
                        [24.117705425003372, 61.82637922050358],
                        [24.118241965082436, 61.82628357166499],
                        [24.118749580529208, 61.82649616208562],
                        [24.118092183864825, 61.82707632306324],
                        [24.119397110731214, 61.82709183205456],
                        [24.119557709062526, 61.82680192906155],
                        [24.120221006932123, 61.82607562248414],
                        [24.12126824239535, 61.82508785960041],
                        [24.121893179630927, 61.824879488501],
                        [24.122306913235768, 61.826308241167204],
                        [24.123298272078568, 61.82798299297984],
                        [24.124019999661193, 61.82914252504936],
                        [24.124100181509387, 61.830213693285565],
                        [24.124427631274276, 61.831546262330434],
                        [24.125114110636286, 61.83258698390325],
                        [24.124274564662187, 61.83382383334904],
                        [24.124490004469237, 61.83409919202899],
                        [24.12551535344424, 61.83442001291172],
                        [24.12640111767844, 61.83476958016764],
                        [24.127127073545644, 61.83425105405835],
                        [24.12761004801634, 61.834592134931825],
                        [24.127851886225507, 61.8355522701725],
                        [24.127992661935906, 61.83625096002712],
                        [24.13249832422908, 61.83672007257935],
                        [24.13441562074847, 61.83692552060754],
                        [24.134597460956236, 61.83647714405277],
                        [24.133889094348405, 61.83570215099001],
                        [24.13386995352463, 61.83504603538985],
                        [24.13473036117601, 61.83480359368869],
                        [24.135372153452654, 61.83483622055182],
                        [24.135766654008304, 61.835509675438196],
                        [24.136331059497703, 61.83587069316346],
                        [24.137202691458974, 61.83595538877671],
                        [24.137388028868255, 61.835476953022265],
                        [24.137348773306265, 61.83514352988925],
                        [24.137529970991736, 61.83433240264283],
                        [24.137880019143733, 61.83397383639131],
                        [24.139063436718235, 61.83373239404232],
                        [24.140035729012688, 61.83386906052911],
                        [24.14073439243203, 61.83429937422214],
                        [24.14174647111082, 61.83438696478728],
                        [24.142699549552784, 61.83397440519799],
                        [24.14316722504593, 61.83348520806201],
                        [24.14416886605243, 61.833306478951286],
                        [24.146872030011345, 61.833745164781824],
                        [24.150614738286453, 61.834355046289346],
                        [24.154690255831245, 61.835171291313415],
                        [24.155016766225312, 61.835444137416715],
                        [24.15611579420356, 61.83573298644534],
                        [24.15561625804305, 61.836188292535255],
                        [24.154466422380782, 61.83644719996008],
                        [24.152748601409805, 61.836760827872006],
                        [24.15160490050908, 61.83695332039383],
                        [24.150681122609104, 61.837050564550395],
                        [24.150431557331384, 61.837843649465334],
                        [24.15028922413014, 61.83823982774386],
                        [24.148876163496038, 61.83905866222705],
                        [24.1497097290471, 61.83917574148268],
                        [24.15063940713167, 61.83939460063046],
                        [24.15127582411123, 61.83974041020209],
                        [24.151440314915018, 61.84024274282492],
                        [24.151789637967667, 61.84064911548825],
                        [24.15352925968846, 61.840103110236214],
                        [24.155699465517813, 61.83946621656221],
                        [24.154420919236777, 61.842250285348065],
                        [24.15428323310604, 61.84259667214413],
                        [24.1541440039068, 61.84295966326733],
                        [24.154032171874686, 61.8434063678152],
                        [24.15340152883658, 61.84337666717331],
                        [24.15294646680378, 61.843350602012706],
                        [24.152323508137982, 61.84323790951221],
                        [24.15175385738365, 61.843309256867855],
                        [24.152019121203825, 61.84386355945257],
                        [24.152575842114082, 61.84468999431689],
                        [24.15196300921712, 61.84522609676602],
                        [24.149942081265845, 61.845766242998394],
                        [24.148795226633858, 61.84598474722693],
                        [24.147444905767628, 61.84668671214484],
                        [24.14692865358957, 61.84679873702615],
                        [24.14545063804278, 61.84754971103387],
                        [24.14516648808215, 61.84810583619118],
                        [24.145662354792087, 61.84821303657046],
                        [24.14768109115556, 61.847234266633784],
                        [24.148505918425062, 61.847038202353886],
                        [24.14952412227616, 61.84698784199301],
                        [24.150574435675654, 61.84688665873096],
                        [24.15109544937619, 61.84715356569481],
                        [24.15140128039208, 61.84764584736288],
                        [24.151549001385224, 61.84876662092191],
                        [24.147205956371295, 61.85866191347966],
                        [24.148284006121347, 61.858696537767386],
                        [24.151538591882787, 61.85743046413708],
                        [24.156123304293565, 61.854784161328006],
                        [24.156992774804113, 61.85386371459469],
                        [24.158767726756178, 61.85219640022973],
                        [24.159605091983476, 61.851621009101784],
                        [24.16104083134085, 61.85086064892816],
                        [24.161758369148636, 61.8503813215153],
                        [24.163208157684444, 61.84941104878084],
                        [24.1639319603086, 61.84891975828562],
                        [24.163757615288446, 61.848354990010506],
                        [24.163805324855694, 61.84802809037402],
                        [24.16366960130913, 61.84723501040222],
                        [24.16367670436505, 61.84659306910232],
                        [24.163835702764924, 61.84600365100319],
                        [24.16396281870593, 61.84575931713323],
                        [24.165648332572832, 61.84448520885099],
                        [24.167996007488455, 61.84282961993645],
                        [24.17035704636728, 61.84102607921699],
                        [24.17271502295649, 61.84136184065215],
                        [24.17292423287126, 61.84132133020048],
                        [24.1730984423796, 61.84131744101645],
                        [24.173658167147842, 61.84124679032277],
                        [24.17450254331267, 61.84117451788905],
                        [24.17502863749197, 61.841125573284856],
                        [24.17503446326582, 61.84103254994262],
                        [24.175521511859714, 61.83770700842491],
                        [24.175533295801863, 61.8375789486909],
                        [24.175580435610613, 61.83739461968385],
                        [24.17566027807595, 61.83718243347268],
                        [24.17572964499917, 61.83708408707395],
                        [24.1758631244761, 61.83694428233229],
                        [24.177816923142867, 61.835045819994455],
                        [24.177979175088005, 61.83492086928514],
                        [24.179451326964223, 61.834908650838635],
                        [24.180715364440044, 61.83467771657134],
                        [24.182178216344703, 61.83385246756353],
                        [24.182937090926206, 61.83346890750304],
                        [24.184067591012727, 61.83330678905274],
                        [24.185011024407252, 61.8332120887664],
                        [24.186004158937955, 61.83323243696605],
                        [24.187222457945772, 61.83342845716424],
                        [24.18868426497499, 61.83392878372242],
                        [24.18968277786089, 61.83422005511843],
                        [24.19038687983353, 61.83443401938137],
                        [24.19076643966667, 61.83457007401886],
                        [24.19947933834932, 61.835246903343396],
                        [24.20001979781591, 61.835272175714884],
                        [24.200678085524988, 61.835328358237405],
                        [24.20136643874911, 61.83538515007332],
                        [24.202143801655957, 61.83545799788578],
                        [24.203059720914492, 61.83533411090545],
                        [24.203852638177754, 61.83523621657324],
                        [24.20416269796676, 61.8351427560724],
                        [24.20531260127638, 61.83476703366449],
                        [24.205936814205916, 61.834169130631324],
                        [24.206304899336903, 61.833803672243015],
                        [24.207078351222325, 61.833919179722656],
                        [24.207115578231015, 61.8331787097762],
                        [24.205700434055565, 61.83249422783487],
                        [24.20414841802955, 61.83232009203838],
                        [24.203032294081826, 61.83232588180086],
                        [24.202995194438113, 61.83176100162127],
                        [24.203259375829276, 61.83133942227209],
                        [24.2035138449437, 61.83102439558635],
                        [24.20321925727385, 61.83060490457936],
                        [24.202923212276772, 61.830214011112595],
                        [24.203056556111616, 61.8300741882972],
                        [24.204840910341623, 61.8283572251578],
                        [24.205127829429863, 61.82817530669419],
                        [24.205294564270194, 61.828010093511324],
                        [24.206260428890992, 61.82700343920613],
                        [24.20560880050502, 61.826876147456964],
                        [24.20458126962368, 61.826242292310006],
                        [24.20438856797039, 61.82615922321514],
                        [24.198127908296115, 61.82243011574479],
                        [24.196938096184407, 61.82233665972977],
                        [24.195306015052058, 61.822202138099264],
                        [24.193930567634577, 61.82209413901536],
                        [24.192948096393955, 61.821999485787785],
                        [24.19184727873022, 61.821909187547845],
                        [24.190690930662402, 61.82180951619592],
                        [24.18947356841773, 61.821718072165815],
                        [24.189340122799894, 61.82163932858959],
                        [24.189208396696525, 61.8215415944867],
                        [24.18911420125632, 61.82147314884069],
                        [24.18608937604052, 61.819177984059166],
                        [24.185983898776247, 61.81923284559496],
                        [24.18579732678209, 61.81929554001326],
                        [24.183226648893072, 61.82037844354387],
                        [24.182771829101757, 61.82007926459661],
                        [24.18238901795472, 61.81987183899573],
                        [24.182041084306967, 61.81972215999324],
                        [24.18081197536222, 61.81910298685327],
                        [24.183477164783003, 61.81764671059655],
                        [24.181720501124943, 61.81642752917639],
                        [24.180463803979706, 61.816986163308584],
                        [24.180287293514485, 61.817267627455685],
                        [24.180446906969017, 61.81782683534114],
                        [24.179124735989724, 61.818441128077744],
                        [24.178821334506242, 61.81879126282704],
                        [24.178604259584397, 61.81918592905966],
                        [24.178270760599066, 61.81953543539541],
                        [24.177595859288683, 61.81966411467562],
                        [24.175753002488875, 61.81971174280117],
                        [24.174578476363326, 61.81970183771469],
                        [24.17405140429399, 61.819534178179566],
                        [24.174267230362318, 61.8191537573685],
                        [24.1804728149983, 61.815903007983145],
                        [24.17899503064078, 61.815587548561275],
                        [24.17783762887784, 61.8150648570551],
                        [24.17642528264882, 61.81469370866071],
                        [24.174963304988587, 61.813879629592726],
                        [24.172669274431914, 61.81501315664397],
                        [24.17232140012982, 61.81508201518771],
                        [24.171901186669402, 61.815063856888365],
                        [24.171254342669105, 61.814888975198485],
                        [24.170207203875474, 61.814760627789944],
                        [24.169988256549804, 61.814681179962015],
                        [24.171679294083933, 61.81388649869005],
                        [24.17162876456454, 61.81369814664861],
                        [24.171198234298448, 61.81345915361582],
                        [24.170259051590033, 61.81333810535038],
                        [24.169687076804717, 61.813406596124025],
                        [24.16928649502349, 61.81333411032284],
                        [24.169226615549682, 61.81312415814262],
                        [24.169499162670476, 61.81286753931004],
                        [24.172321092537757, 61.81181286747325],
                        [24.171916793369384, 61.81129383603958],
                        [24.170257686142843, 61.8103330920291],
                        [24.16984562068349, 61.81011791077891],
                        [24.16961636938306, 61.81020821486001],
                        [24.163648619236852, 61.81284092617834],
                        [24.163622352164673, 61.813125474575145],
                        [24.16354595375125, 61.81340898733351],
                        [24.163375876863007, 61.813619303197235],
                        [24.163037992319254, 61.8137429878149],
                        [24.162427714922103, 61.8138253982509],
                        [24.161926438885537, 61.813815037708736],
                        [24.16085434865646, 61.81381773798681],
                        [24.159847267512344, 61.81376015168654],
                        [24.15884707314695, 61.81344248255582],
                        [24.157719409118886, 61.813145927004086],
                        [24.156707928366867, 61.81349322259008],
                        [24.155608103945557, 61.81398123146414],
                        [24.15530163535942, 61.8143074942371],
                        [24.155215488890576, 61.814424491056734],
                        [24.152046452594607, 61.814477568495995],
                        [24.151933221367887, 61.81434455350516],
                        [24.15176515702764, 61.81424954874741],
                        [24.15162555393712, 61.81415542165854],
                        [24.15145632778275, 61.814060679844424],
                        [24.151158500095733, 61.81395144796129],
                        [24.14913767460862, 61.812997182688925],
                        [24.145884570919694, 61.81160554771331],
                        [24.145642784168736, 61.811505489993344],
                        [24.145476179615173, 61.81140699498255],
                        [24.14502808030729, 61.811635260172224],
                        [24.14452327434014, 61.811933615788355],
                        [24.145032759805268, 61.81239561607759],
                        [24.14534459894012, 61.81263325075371],
                        [24.14574283529015, 61.813211726129914],
                        [24.1457750473904, 61.813398289964745],
                        [24.146267691912776, 61.81404942220416],
                        [24.146849081377834, 61.81460318826102],
                        [24.14676745456687, 61.81515742259162],
                        [24.14652387991563, 61.81550873422508],
                        [24.146358647835612, 61.81598995983744],
                        [24.14635038423289, 61.81640318549846],
                        [24.146737105434003, 61.81678184229917],
                        [24.147041863955145, 61.81674540668254],
                        [24.147465927875597, 61.81639785278043],
                        [24.14815934928072, 61.816070148386686],
                        [24.148815785507647, 61.816140804652385],
                        [24.149579067843998, 61.816684078540874],
                        [24.149273708031366, 61.817376219942076],
                        [24.14948369937276, 61.81803630091563],
                        [24.149279457849598, 61.818288641784825],
                        [24.148710562804553, 61.818248318206],
                        [24.147542732581478, 61.818167039888586],
                        [24.138663325224723, 61.81739781048027],
                        [24.13859165251459, 61.81719674102609],
                        [24.138481437942165, 61.816438944651416],
                        [24.138662300519123, 61.816114851152356],
                        [24.13937170478736, 61.81561646814112],
                        [24.140225261018617, 61.81486449318517],
                        [24.140359576348114, 61.81406902336197],
                        [24.141236486840295, 61.81338879169378],
                        [24.14232221793722, 61.81305502855571],
                        [24.140611742337754, 61.81200731756582],
                        [24.13995447055107, 61.811623005583364],
                        [24.13850686228051, 61.81066626909341],
                        [24.13759765283321, 61.811046441176686],
                        [24.13615727918378, 61.81162936121936],
                        [24.133685915067154, 61.812604119991704],
                        [24.13208143866513, 61.81171531914303],
                        [24.131483469815866, 61.81198792239297],
                        [24.130942509022166, 61.81261808166753],
                        [24.131401482816756, 61.813511479554506],
                        [24.13090300642051, 61.81368637560568],
                        [24.128798865304077, 61.81459746143723],
                        [24.128648186836852, 61.81395282918893],
                        [24.12827949890082, 61.813061318475846],
                        [24.126447104300304, 61.811711521342154],
                        [24.126835644549917, 61.810778827600984],
                        [24.12712224328036, 61.81061376028109],
                        [24.128337630526893, 61.81018303590046],
                        [24.129113339785146, 61.8099426756163],
                        [24.130809270884114, 61.80935029383567],
                        [24.132735762996177, 61.808578653693424],
                        [24.13373781082698, 61.80817194004449],
                        [24.135256495991346, 61.80762856263304],
                        [24.13673324932468, 61.8070655649578],
                        [24.13807657720259, 61.80655189919128],
                        [24.141377658406398, 61.80539478369192],
                        [24.1400957308386, 61.804926171320666],
                        [24.13794233567937, 61.80411151622066],
                        [24.136199343170546, 61.80341943720902],
                        [24.134455122675288, 61.802741556335825],
                        [24.13320480480118, 61.80225928898805],
                        [24.132213177863164, 61.801910701881596],
                        [24.13032082295887, 61.80249836880109],
                        [24.12834302843182, 61.8033550453213],
                        [24.128585708288117, 61.80365948331286],
                        [24.128861101230058, 61.80393608374356],
                        [24.129277520817023, 61.80431542594632],
                        [24.128915721105077, 61.80496358818072],
                        [24.12870069495717, 61.805356717816004],
                        [24.128114354277322, 61.80580211344565],
                        [24.127408192316917, 61.805944128988926],
                        [24.12642552464913, 61.80646526067317],
                        [24.125916492816415, 61.80675394789152],
                        [24.124634429302603, 61.807254533808134],
                        [24.12365970150045, 61.807690267167025],
                        [24.12339726422671, 61.80824069651626],
                        [24.123639358389063, 61.80887299617833],
                        [24.123073178255755, 61.81041491268275],
                        [24.123430254201438, 61.81110664651055],
                        [24.12275951666736, 61.81183384096893],
                        [24.122889330826318, 61.81237825134845],
                        [24.12248656186996, 61.81313957244312],
                        [24.122278878365865, 61.81374818156123],
                        [24.122070445704033, 61.81404316567077],
                        [24.121621382728176, 61.81433310516245],
                        [24.119407411667925, 61.81576917474202],
                        [24.117364658596255, 61.815579923797344],
                        [24.114571046646972, 61.81528272491961],
                        [24.113048482799787, 61.81456139857732],
                        [24.111097644784362, 61.81383611007666],
                        [24.10987604717471, 61.81226887339248],
                        [24.10691758621984, 61.812257336748736],
                        [24.106779848378405, 61.812254425250316],
                        [24.106756354457442, 61.812340986064655],
                        [24.10674885532799, 61.81242062553961],
                        [24.106643918479996, 61.814674510374964],
                        [24.105587386756774, 61.81514554393515],
                        [24.105457427972606, 61.815222592822806],
                        [24.105255033797352, 61.81521281024244],
                        [24.105055035719648, 61.81520359890615],
                        [24.104876133487938, 61.81519482311573],
                        [24.10469674179664, 61.815191040399036],
                        [24.104526514933898, 61.81520245262483],
                        [24.10435816978667, 61.815193898787015],
                        [24.10417783762943, 61.81520009383586],
                        [24.1040094926037, 61.815191539571316],
                        [24.10383971646206, 61.81519796580732],
                        [24.1036915248449, 61.81519984351515],
                        [24.103480011594975, 61.81520037626907],
                        [24.1032900821463, 61.81519636940818],
                        [24.103195003925233, 61.815318529049414],
                        [24.103058590116696, 61.81548671771208],
                        [24.102859352952596, 61.81568208433372],
                        [24.102748991165534, 61.81589357340918],
                        [24.10019677858686, 61.81918000680856],
                        [24.100080834399026, 61.81934386412529],
                        [24.100752491504203, 61.81967879177014],
                        [24.101549481894185, 61.82001636143758],
                        [24.10217305115494, 61.820252098399656],
                        [24.10194009205844, 61.82120064823184],
                        [24.099637361566106, 61.821912297271226],
                        [24.098599883177375, 61.822258629367724],
                        [24.097506638990918, 61.82274032896472],
                        [24.095990967825195, 61.82374333989929],
                        [24.09748223616868, 61.82423104248461],
                        [24.0982466150705, 61.82446387034225],
                        [24.0981298064821, 61.82471515054661],
                        [24.095653889868682, 61.82507619174154],
                        [24.093902672147934, 61.82542403144289],
                        [24.092606748995433, 61.825738719617675],
                        [24.09070499695769, 61.82608332374335],
                        [24.089403215495665, 61.826141270368375],
                        [24.085648580379544, 61.8266318311127],
                        [24.083494944407587, 61.82767388718975],
                        [24.081095303766425, 61.828545095006916],
                        [24.07882575959022, 61.82926661064105],
                        [24.07303542088117, 61.82851100902429],
                        [24.07152411863614, 61.82874544435689],
                        [24.073661561582195, 61.829095123512914],
                        [24.077474690058025, 61.829912288379916],
                        [24.07985870263765, 61.829873297398585],
                        [24.088618078304734, 61.82739300769212],
                        [24.093929808883242, 61.827279818951],
                        [24.09442380667255, 61.827634776969376],
                        [24.1018155292866, 61.826246684135036],
                        [24.1027333000413, 61.82711661128873],
                        [24.105031658011132, 61.82720072212051],
                        [24.10519645586709, 61.82721132837081],
                        [24.105315476389517, 61.82722809324754],
                    ],
                    [
                        [24.157351566956027, 61.81900343948464],
                        [24.158408919156862, 61.81847218121167],
                        [24.15961327343791, 61.81787721291799],
                        [24.159957166009587, 61.81786524618109],
                        [24.16024154476743, 61.8178425169318],
                        [24.160711443494474, 61.81777594184374],
                        [24.161165645084584, 61.81766135927116],
                        [24.161561094140907, 61.81774582616025],
                        [24.162037049585305, 61.817831964743675],
                        [24.162506963378526, 61.817765383880634],
                        [24.16296201948846, 61.817641264277995],
                        [24.163383840668573, 61.817440173711844],
                        [24.163859878420574, 61.81730695380988],
                        [24.164145147245858, 61.81727469511785],
                        [24.164543253598328, 61.81733060665148],
                        [24.16530446101351, 61.817384473425165],
                        [24.165728849474835, 61.817374163043944],
                        [24.16593974048005, 61.81727361341548],
                        [24.16587240974766, 61.81712916193467],
                        [24.16563012788643, 61.81691434723829],
                        [24.165351101378466, 61.816660632071496],
                        [24.16512103278933, 61.81653190022063],
                        [24.164807848254128, 61.816430062391696],
                        [24.16455412030075, 61.81633899145166],
                        [24.164427304273037, 61.816183788854126],
                        [24.16423047420112, 61.816132033710055],
                        [24.16399162710094, 61.81609849017837],
                        [24.163837656336614, 61.81601900906537],
                        [24.163911226542023, 61.81587747566881],
                        [24.164252537319467, 61.81567471091021],
                        [24.16471546053956, 61.81546492572325],
                        [24.164954395225713, 61.815279125052555],
                        [24.165214226082146, 61.8153035603569],
                        [24.165516090428486, 61.81530980113738],
                        [24.16578645929884, 61.81522001059566],
                        [24.166119847649068, 61.81510291862802],
                        [24.16647071090174, 61.81501478808899],
                        [24.166843457416334, 61.81490802852282],
                        [24.167231940053075, 61.81484930084567],
                        [24.167655397079617, 61.81484849667473],
                        [24.168143559267122, 61.81502068896193],
                        [24.16818023866665, 61.81527894928737],
                        [24.168253700025403, 61.81535675609896],
                        [24.168114554856793, 61.81555416018184],
                        [24.16804446316781, 61.81587697036507],
                        [24.16772930295845, 61.81645222067416],
                        [24.167645255806242, 61.81670798193209],
                        [24.167641672428886, 61.81696540289862],
                        [24.16742462618681, 61.817132588990326],
                        [24.16732132085303, 61.817378421969885],
                        [24.16717509967937, 61.8176519800864],
                        [24.166917803609746, 61.81781832613181],
                        [24.163212253943083, 61.81951137793255],
                        [24.161955395016292, 61.81941413740006],
                        [24.16020447030953, 61.81924655503607],
                        [24.159811033863505, 61.8192309443611],
                        [24.15954507554465, 61.81920303086887],
                        [24.15924623311872, 61.81918937520222],
                        [24.15897958578953, 61.81916892015123],
                        [24.158697186809974, 61.81914812967522],
                        [24.158400413837068, 61.819112111522394],
                        [24.158196817774076, 61.81909295067693],
                        [24.15796240569905, 61.81906568691989],
                        [24.157616959376085, 61.81904358931939],
                        [24.157351566956027, 61.81900343948464],
                    ],
                ]
            },
        }
    ],
}

naturaspa_query_response = {
    "displayFieldName": "naturaTunnus",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "naturaTunnus": "naturaTunnus",
        "suojeluPerusteTunnus": "suojeluPerusteTunnus",
        "versioTunnus": "versioTunnus",
        "nimiSuomi": "nimiSuomi",
        "nimiRuotsi": "nimiRuotsi",
        "alueTyyppi": "alueTyyppi",
        "tietolomakeURL": "tietolomakeURL",
        "paatosPvm": "paatosPvm",
        "paatosPAla_ha": "paatosPAla_ha",
        "paatosPituus_m": "paatosPituus_m",
        "meriPAlaProsentti": "meriPAlaProsentti",
        "paatosAsiakirja": "paatosAsiakirja",
        "ensisijLajiLuonto": "ensisijLajiLuonto",
        "alueJaViiva": "alueJaViiva",
        "VPDSuoj": "VPDSuoj",
        "lisatieto": "lisatieto",
        "luontiPvm": "luontiPvm",
        "muutosPvm": "muutosPvm",
        "paattymisPvm": "paattymisPvm",
        "SHAPE.STArea()": "SHAPE.STArea()",
        "SHAPE.STLength()": "SHAPE.STLength()",
    },
    "geometryType": "esriGeometryPolygon",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {
            "name": "naturaTunnus",
            "type": "esriFieldTypeString",
            "alias": "naturaTunnus",
            "length": 9,
        },
        {
            "name": "suojeluPerusteTunnus",
            "type": "esriFieldTypeString",
            "alias": "suojeluPerusteTunnus",
            "length": 15,
        },
        {
            "name": "versioTunnus",
            "type": "esriFieldTypeDate",
            "alias": "versioTunnus",
            "length": 8,
        },
        {
            "name": "nimiSuomi",
            "type": "esriFieldTypeString",
            "alias": "nimiSuomi",
            "length": 150,
        },
        {
            "name": "nimiRuotsi",
            "type": "esriFieldTypeString",
            "alias": "nimiRuotsi",
            "length": 150,
        },
        {
            "name": "alueTyyppi",
            "type": "esriFieldTypeString",
            "alias": "alueTyyppi",
            "length": 10,
        },
        {
            "name": "tietolomakeURL",
            "type": "esriFieldTypeString",
            "alias": "tietolomakeURL",
            "length": 1000,
        },
        {
            "name": "paatosPvm",
            "type": "esriFieldTypeDate",
            "alias": "paatosPvm",
            "length": 8,
        },
        {
            "name": "paatosPAla_ha",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPAla_ha",
        },
        {
            "name": "paatosPituus_m",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPituus_m",
        },
        {
            "name": "meriPAlaProsentti",
            "type": "esriFieldTypeDouble",
            "alias": "meriPAlaProsentti",
        },
        {
            "name": "paatosAsiakirja",
            "type": "esriFieldTypeString",
            "alias": "paatosAsiakirja",
            "length": 230,
        },
        {
            "name": "ensisijLajiLuonto",
            "type": "esriFieldTypeInteger",
            "alias": "ensisijLajiLuonto",
        },
        {"name": "alueJaViiva", "type": "esriFieldTypeInteger", "alias": "alueJaViiva"},
        {"name": "VPDSuoj", "type": "esriFieldTypeInteger", "alias": "VPDSuoj"},
        {
            "name": "lisatieto",
            "type": "esriFieldTypeString",
            "alias": "lisatieto",
            "length": 200,
        },
        {
            "name": "luontiPvm",
            "type": "esriFieldTypeDate",
            "alias": "luontiPvm",
            "length": 8,
        },
        {
            "name": "muutosPvm",
            "type": "esriFieldTypeDate",
            "alias": "muutosPvm",
            "length": 8,
        },
        {
            "name": "paattymisPvm",
            "type": "esriFieldTypeDate",
            "alias": "paattymisPvm",
            "length": 8,
        },
        {
            "name": "SHAPE.STArea()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STArea()",
        },
        {
            "name": "SHAPE.STLength()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STLength()",
        },
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 86,
                "naturaTunnus": "FI0333004",
                "suojeluPerusteTunnus": "SPAFI0333004",
                "versioTunnus": 1473724800000,
                "nimiSuomi": "Kaakkurijärvet",
                "nimiRuotsi": "Kaakkurijärvet",
                "alueTyyppi": "SAC/SPA",
                "tietolomakeURL": None,
                "paatosPvm": 1427414400000,
                "paatosPAla_ha": 574.0,
                "paatosPituus_m": 0.0,
                "meriPAlaProsentti": 0.0,
                "paatosAsiakirja": "http://www.finlex.fi/fi/laki/alkup/2015/20150354",
                "ensisijLajiLuonto": 1,
                "alueJaViiva": 0,
                "VPDSuoj": 1,
                "lisatieto": " ",
                "luontiPvm": 1473724800000,
                "muutosPvm": None,
                "paattymisPvm": None,
                "SHAPE.STArea()": 5737997.964111328,
                "SHAPE.STLength()": 25525.740547265672,
            },
            "geometry": {
                "rings": [
                    [
                        [23.47828733529358, 61.52495153062216],
                        [23.4821477618182, 61.52598050541586],
                        [23.4844463292183, 61.52660546540002],
                        [23.486434878162914, 61.526979977971536],
                        [23.488660473407666, 61.52675448607636],
                        [23.490603114852064, 61.52603683178938],
                        [23.492094032154466, 61.524822685969056],
                        [23.491719686301163, 61.52364133443586],
                        [23.490736654459674, 61.52260593432698],
                        [23.491520695420718, 61.521656418909274],
                        [23.491444952622615, 61.520078703352105],
                        [23.490168038084068, 61.519399367288905],
                        [23.488179941750502, 61.51902492157648],
                        [23.4855877862519, 61.51875609144785],
                        [23.484482112500796, 61.51880837751913],
                        [23.483508684188163, 61.51918730887632],
                        [23.480971251811386, 61.51992989838402],
                        [23.47957595987256, 61.52029791191474],
                        [23.478164752007757, 61.520059434665235],
                        [23.477159443331452, 61.519225366533355],
                        [23.47596266323598, 61.518588356215794],
                        [23.475215064441958, 61.51772053983475],
                        [23.474622512095358, 61.51697792958863],
                        [23.473407593793624, 61.51650204731042],
                        [23.472769410829002, 61.51616229844071],
                        [23.47072027769383, 61.5155839847923],
                        [23.46973560354985, 61.5153160553231],
                        [23.469190989784614, 61.5148979051134],
                        [23.46817693601321, 61.51414434322248],
                        [23.46698053446165, 61.51350725657821],
                        [23.464674089549895, 61.51296258882932],
                        [23.462823348065957, 61.512874156708584],
                        [23.46095424386916, 61.51294683695612],
                        [23.460466593278802, 61.51277254986331],
                        [23.459416130614862, 61.512341219233534],
                        [23.457263088989524, 61.51119432424964],
                        [23.455050516355254, 61.510571119821236],
                        [23.451531790481962, 61.51027750954939],
                        [23.448851761717034, 61.5100460679744],
                        [23.448275301932387, 61.509909833866644],
                        [23.448419442453588, 61.50938832112353],
                        [23.44847003935372, 61.50894518736479],
                        [23.44919367947697, 61.507792294266025],
                        [23.44879355638609, 61.50685255035751],
                        [23.447953499928754, 61.50606295381318],
                        [23.446579999509595, 61.50550187469079],
                        [23.44453808247461, 61.50561022880891],
                        [23.442880873678615, 61.50605183720176],
                        [23.441907335416786, 61.50643046184736],
                        [23.44109320071055, 61.506894060342496],
                        [23.44093483481585, 61.50737388418988],
                        [23.44087607879231, 61.50771052752796],
                        [23.440851047160102, 61.50810602474835],
                        [23.44064815640895, 61.50864182286008],
                        [23.44016328308596, 61.50934417449539],
                        [23.440303173244736, 61.509888916908665],
                        [23.441708628950913, 61.51038499266254],
                        [23.444028286176742, 61.51080919288543],
                        [23.4435790066369, 61.51103990264524],
                        [23.44274173529319, 61.511704938141165],
                        [23.442986878035715, 61.512519435710765],
                        [23.443199780366715, 61.51361593750864],
                        [23.44399244928054, 61.51408108369761],
                        [23.445047356053205, 61.514472256938944],
                        [23.446186626164938, 61.514865612251306],
                        [23.44708670360977, 61.51513151073459],
                        [23.447528311958344, 61.51570869474665],
                        [23.447703092756257, 61.51640013495822],
                        [23.448370126500965, 61.51722563188985],
                        [23.449192084139263, 61.51817636341141],
                        [23.45021654125192, 61.51957681408618],
                        [23.45128247158394, 61.520614709357574],
                        [23.452820845891964, 61.521220420636745],
                        [23.454537160473315, 61.52174993400391],
                        [23.45655715049389, 61.52184286886591],
                        [23.458768791323905, 61.521738725051016],
                        [23.459808637988605, 61.5215233119628],
                        [23.460711828518583, 61.52102149998078],
                        [23.46205510653018, 61.520369499981754],
                        [23.463459768542208, 61.51992108904877],
                        [23.464725052159846, 61.519953918791444],
                        [23.46594912635414, 61.52034930870762],
                        [23.466933906100714, 61.5206172658366],
                        [23.468588977146496, 61.52094299402813],
                        [23.467986703973914, 61.52177588038326],
                        [23.467341277442717, 61.52224400635632],
                        [23.467375277978984, 61.52268935227629],
                        [23.468380412974987, 61.5235234815937],
                        [23.469356163132765, 61.52387199177825],
                        [23.47126452236482, 61.52420424321003],
                        [23.47244562726914, 61.524234818987324],
                        [23.47472806950695, 61.52425346479565],
                        [23.476096196232216, 61.52412721394755],
                        [23.477493874226763, 61.52448658742175],
                        [23.47828733529358, 61.52495153062216],
                    ],
                    [
                        [23.47116284367196, 61.51124601363247],
                        [23.475197826582008, 61.511376589421005],
                        [23.478079600546458, 61.51105893743408],
                        [23.479557337059013, 61.51057424763689],
                        [23.48033160395465, 61.51001908448608],
                        [23.48067081098902, 61.50895592907693],
                        [23.480821234721404, 61.508593803547505],
                        [23.481698646633074, 61.50809358061672],
                        [23.482539158946867, 61.507435541397946],
                        [23.482258970065, 61.5070099981602],
                        [23.4813152328787, 61.50664576546661],
                        [23.480566141620965, 61.506495695169306],
                        [23.479734516311932, 61.50610819560958],
                        [23.479069519974388, 61.50569885430742],
                        [23.47881541895136, 61.505208204739986],
                        [23.477699803308738, 61.50474841667276],
                        [23.476101531068913, 61.50436720722489],
                        [23.474091852633517, 61.50423678719107],
                        [23.472997827610826, 61.50423460749541],
                        [23.472151560002597, 61.5039773976724],
                        [23.47126260156544, 61.50361450958788],
                        [23.47067301706724, 61.50302406640659],
                        [23.47009825989619, 61.50230328623379],
                        [23.469370053067443, 61.501970681600596],
                        [23.46596643434813, 61.50062751933845],
                        [23.463440012842458, 61.49975147806141],
                        [23.462309368683897, 61.499591407404615],
                        [23.462027754315418, 61.49966252097575],
                        [23.46074175770552, 61.500387302047756],
                        [23.45929798367185, 61.50105568814905],
                        [23.458483864181655, 61.50147898013859],
                        [23.457494216780265, 61.50200228133972],
                        [23.45581726851808, 61.502795280998775],
                        [23.454476551031362, 61.50318564831814],
                        [23.453801007799147, 61.503684017658074],
                        [23.452932765219447, 61.50448852083763],
                        [23.452661171090803, 61.50474233246478],
                        [23.452263806023755, 61.50485759352754],
                        [23.45160765464458, 61.504937133018004],
                        [23.451136979645952, 61.50497415843106],
                        [23.449997290744317, 61.50489217878675],
                        [23.44928807151506, 61.50487370032222],
                        [23.448891328512747, 61.50499409040092],
                        [23.449871331239006, 61.50551637123907],
                        [23.451060670759386, 61.50612253174154],
                        [23.451937566629912, 61.50658982687972],
                        [23.453220196394067, 61.50685852196671],
                        [23.45428758675958, 61.507095453341805],
                        [23.455682336528106, 61.50734089964436],
                        [23.457514705045654, 61.508068308945454],
                        [23.459211322808574, 61.509027451750285],
                        [23.4602770100639, 61.50976104082372],
                        [23.462552095825107, 61.51044758279129],
                        [23.464231737787074, 61.51059575538627],
                        [23.467375769866145, 61.51086030743176],
                        [23.47116284367196, 61.51124601363247],
                    ],
                    [
                        [23.50102454084897, 61.53461353681036],
                        [23.50204643045801, 61.53508894496409],
                        [23.502809875743083, 61.53547216727079],
                        [23.5056827167235, 61.53702173444789],
                        [23.507118035766744, 61.537807163291504],
                        [23.508979577442595, 61.53838959506872],
                        [23.510501306168777, 61.538407144232124],
                        [23.511888992602692, 61.538421265996384],
                        [23.51456538231742, 61.53853248663998],
                        [23.516021659036383, 61.53833441019214],
                        [23.51813463470125, 61.53787501598714],
                        [23.52118452229658, 61.537096884188784],
                        [23.517057669263565, 61.534790390059435],
                        [23.521901537446414, 61.53238262667514],
                        [23.523452035920226, 61.53240653044374],
                        [23.52424973523636, 61.532084634600295],
                        [23.524741852593035, 61.53169076689334],
                        [23.5250719101506, 61.53114303931095],
                        [23.525259063269463, 61.53027082547659],
                        [23.524549024138206, 61.53020994584773],
                        [23.52263755370252, 61.530075644259355],
                        [23.521525444173534, 61.53000450307807],
                        [23.52092214809386, 61.529922855350776],
                        [23.520627019980232, 61.52984767617851],
                        [23.520135787194345, 61.52953562841848],
                        [23.519651250443566, 61.52873744068097],
                        [23.519060964636246, 61.528807930047954],
                        [23.518331857419053, 61.5289176556975],
                        [23.516746029407376, 61.52947605946327],
                        [23.514632849877405, 61.53034183067816],
                        [23.51332052088221, 61.53045800843065],
                        [23.511410663792223, 61.53070860774983],
                        [23.509353903314693, 61.53146878969321],
                        [23.507201612495187, 61.53068639394429],
                        [23.506000181945673, 61.53061283774587],
                        [23.50407438120567, 61.53060624138824],
                        [23.502023194624563, 61.53091727647871],
                        [23.50063730980335, 61.53128812343967],
                        [23.500152122388915, 61.53161790688813],
                        [23.499698609496097, 61.5324618742374],
                        [23.49976297587941, 61.53308383640725],
                        [23.499810488906274, 61.53385510542125],
                        [23.50102454084897, 61.53461353681036],
                    ],
                    [
                        [23.518359021413033, 61.52173176706592],
                        [23.51675035777416, 61.521456823609334],
                        [23.515904916016826, 61.52100740915333],
                        [23.51590659432317, 61.520104322172244],
                        [23.515555639495584, 61.51923975021361],
                        [23.514914067212104, 61.5187480017611],
                        [23.513846335324445, 61.51850678987452],
                        [23.51236571822558, 61.51839761865337],
                        [23.51048816253906, 61.51827825244941],
                        [23.509250327228848, 61.51822279938883],
                        [23.508623943654904, 61.51804038461566],
                        [23.508044491204082, 61.51788293790783],
                        [23.507246947807364, 61.518337836219075],
                        [23.506744444976277, 61.518824060257096],
                        [23.50620732626768, 61.51961837245316],
                        [23.504777966318933, 61.51993822751376],
                        [23.503481446910868, 61.520404079742164],
                        [23.502280449813124, 61.52134770415749],
                        [23.501214893945164, 61.52241363991461],
                        [23.500908083907667, 61.52292863630831],
                        [23.50105855827311, 61.52336030275926],
                        [23.50206502243796, 61.52414668101746],
                        [23.50394986812626, 61.524646601174695],
                        [23.50570455670696, 61.524976794355624],
                        [23.506402021225526, 61.5249709090675],
                        [23.510098598700456, 61.52485169278647],
                        [23.512535765380285, 61.52486652956828],
                        [23.51193132412587, 61.52537394295891],
                        [23.51144383807152, 61.52616952678029],
                        [23.511399466385406, 61.527451796199145],
                        [23.51196049731781, 61.5277751169191],
                        [23.513127789756933, 61.528018884098046],
                        [23.514046940703548, 61.52825628789643],
                        [23.51557767155181, 61.52836672186219],
                        [23.516672313239376, 61.528370932306636],
                        [23.5177881970123, 61.528185536169794],
                        [23.51919243423918, 61.52784004310639],
                        [23.51903067553364, 61.52731413544284],
                        [23.519313367360162, 61.52701238719637],
                        [23.5195782394891, 61.526424986842706],
                        [23.51957352791336, 61.52552125381398],
                        [23.519512442946212, 61.52462114081237],
                        [23.51835725571208, 61.52391530295849],
                        [23.517859267794293, 61.52355285695612],
                        [23.517949537628436, 61.52274709071405],
                        [23.518359021413033, 61.52173176706592],
                    ],
                    [
                        [23.487542322428155, 61.53216807457019],
                        [23.486717573531084, 61.53189451496359],
                        [23.48470668725912, 61.531650449785694],
                        [23.481877273659816, 61.53130113310266],
                        [23.480187252935618, 61.53111332905316],
                        [23.478404324970377, 61.531079306864314],
                        [23.47697062084198, 61.531294574336236],
                        [23.476101805033444, 61.531632561677014],
                        [23.47555373817074, 61.5320268946214],
                        [23.47506130124748, 61.53237459503313],
                        [23.474644117027342, 61.53272424846902],
                        [23.474596550905968, 61.533143523217326],
                        [23.474933544683427, 61.53350066843365],
                        [23.475383777018784, 61.533968856051715],
                        [23.47594529255554, 61.53434381656149],
                        [23.47645798869561, 61.53470548912299],
                        [23.477236581987256, 61.534941873931174],
                        [23.47783683365956, 61.53519766855481],
                        [23.47941107914202, 61.53529839565341],
                        [23.481965450301352, 61.53541238817876],
                        [23.483703877828574, 61.53539717020576],
                        [23.484886088957868, 61.53540361998357],
                        [23.485932660078724, 61.53527440084911],
                        [23.48679740961175, 61.53497229979516],
                        [23.487373912860818, 61.53477089330614],
                        [23.487796381042276, 61.53437327984172],
                        [23.488188991866096, 61.53379468281026],
                        [23.488376120106068, 61.53347510155542],
                        [23.488494707673023, 61.533093689879195],
                        [23.488292510443618, 61.53265596669296],
                        [23.487895704254324, 61.532381420380844],
                        [23.487542322428155, 61.53216807457019],
                    ],
                    [
                        [23.462710809288144, 61.528558430383534],
                        [23.463641860992983, 61.52855854385617],
                        [23.464726200341513, 61.528538613719945],
                        [23.466092775396405, 61.52824965484614],
                        [23.46770280148109, 61.52781079552532],
                        [23.468424570982, 61.52721673845621],
                        [23.4687652942214, 61.52643260235296],
                        [23.468301049979868, 61.525867896912786],
                        [23.467072736904736, 61.52516324143586],
                        [23.46582949738227, 61.52459035187383],
                        [23.46463972901239, 61.52421107692597],
                        [23.46284714822875, 61.52404441008745],
                        [23.461088375220182, 61.52402279532753],
                        [23.459845482633693, 61.52411067566887],
                        [23.45852103949133, 61.52447275454491],
                        [23.45759573425159, 61.52508549417967],
                        [23.4574749049555, 61.52526257137219],
                        [23.457409373329714, 61.525837573373465],
                        [23.45727537922421, 61.52635073001795],
                        [23.457353035967486, 61.52677327500319],
                        [23.457588022370132, 61.527139823607826],
                        [23.45835317051388, 61.527712376639265],
                        [23.45957079272712, 61.52806840751553],
                        [23.461326240551195, 61.52834226696409],
                        [23.462710809288144, 61.528558430383534],
                    ],
                ]
            },
        }
    ],
}

naturasci_query_response = {
    "displayFieldName": "naturaTunnus",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "naturaTunnus": "naturaTunnus",
        "suojeluPerusteTunnus": "suojeluPerusteTunnus",
        "versioTunnus": "versioTunnus",
        "nimiSuomi": "nimiSuomi",
        "nimiRuotsi": "nimiRuotsi",
        "alueTyyppi": "alueTyyppi",
        "tietolomakeURL": "tietolomakeURL",
        "paatosPvm": "paatosPvm",
        "paatosPAla_ha": "paatosPAla_ha",
        "paatosPituus_m": "paatosPituus_m",
        "meriPAlaProsentti": "meriPAlaProsentti",
        "paatosAsiakirja": "paatosAsiakirja",
        "ensisijLajiLuonto": "ensisijLajiLuonto",
        "alueJaViiva": "alueJaViiva",
        "VPDSuoj": "VPDSuoj",
        "lisatieto": "lisatieto",
        "luontiPvm": "luontiPvm",
        "muutosPvm": "muutosPvm",
        "paattymisPvm": "paattymisPvm",
        "SHAPE.STArea()": "SHAPE.STArea()",
        "SHAPE.STLength()": "SHAPE.STLength()",
    },
    "geometryType": "esriGeometryPolygon",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {
            "name": "naturaTunnus",
            "type": "esriFieldTypeString",
            "alias": "naturaTunnus",
            "length": 9,
        },
        {
            "name": "suojeluPerusteTunnus",
            "type": "esriFieldTypeString",
            "alias": "suojeluPerusteTunnus",
            "length": 15,
        },
        {
            "name": "versioTunnus",
            "type": "esriFieldTypeDate",
            "alias": "versioTunnus",
            "length": 8,
        },
        {
            "name": "nimiSuomi",
            "type": "esriFieldTypeString",
            "alias": "nimiSuomi",
            "length": 150,
        },
        {
            "name": "nimiRuotsi",
            "type": "esriFieldTypeString",
            "alias": "nimiRuotsi",
            "length": 150,
        },
        {
            "name": "alueTyyppi",
            "type": "esriFieldTypeString",
            "alias": "alueTyyppi",
            "length": 10,
        },
        {
            "name": "tietolomakeURL",
            "type": "esriFieldTypeString",
            "alias": "tietolomakeURL",
            "length": 1000,
        },
        {
            "name": "paatosPvm",
            "type": "esriFieldTypeDate",
            "alias": "paatosPvm",
            "length": 8,
        },
        {
            "name": "paatosPAla_ha",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPAla_ha",
        },
        {
            "name": "paatosPituus_m",
            "type": "esriFieldTypeDouble",
            "alias": "paatosPituus_m",
        },
        {
            "name": "meriPAlaProsentti",
            "type": "esriFieldTypeDouble",
            "alias": "meriPAlaProsentti",
        },
        {
            "name": "paatosAsiakirja",
            "type": "esriFieldTypeString",
            "alias": "paatosAsiakirja",
            "length": 230,
        },
        {
            "name": "ensisijLajiLuonto",
            "type": "esriFieldTypeInteger",
            "alias": "ensisijLajiLuonto",
        },
        {"name": "alueJaViiva", "type": "esriFieldTypeInteger", "alias": "alueJaViiva"},
        {"name": "VPDSuoj", "type": "esriFieldTypeInteger", "alias": "VPDSuoj"},
        {
            "name": "lisatieto",
            "type": "esriFieldTypeString",
            "alias": "lisatieto",
            "length": 200,
        },
        {
            "name": "luontiPvm",
            "type": "esriFieldTypeDate",
            "alias": "luontiPvm",
            "length": 8,
        },
        {
            "name": "muutosPvm",
            "type": "esriFieldTypeDate",
            "alias": "muutosPvm",
            "length": 8,
        },
        {
            "name": "paattymisPvm",
            "type": "esriFieldTypeDate",
            "alias": "paattymisPvm",
            "length": 8,
        },
        {
            "name": "SHAPE.STArea()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STArea()",
        },
        {
            "name": "SHAPE.STLength()",
            "type": "esriFieldTypeDouble",
            "alias": "SHAPE.STLength()",
        },
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 4,
                "naturaTunnus": "FI0100006",
                "suojeluPerusteTunnus": "SCIFI0100006",
                "versioTunnus": 1544486400000,
                "nimiSuomi": "Tulliniemen linnustonsuojelualue",
                "nimiRuotsi": "Tulluddens fågelskyddsområde",
                "alueTyyppi": "SCI",
                "tietolomakeURL": None,
                "paatosPvm": 1543968000000,
                "paatosPAla_ha": 8699.0,
                "paatosPituus_m": 0.0,
                "meriPAlaProsentti": 96.0,
                "paatosAsiakirja": None,
                "ensisijLajiLuonto": 1,
                "alueJaViiva": 0,
                "VPDSuoj": None,
                "lisatieto": "SAC-alueen laajennus",
                "luontiPvm": 1473724800000,
                "muutosPvm": 1544486400000,
                "paattymisPvm": None,
                "SHAPE.STArea()": 88865094.1040039,
                "SHAPE.STLength()": 52465.55519398873,
            },
            "geometry": {
                "rings": [
                    [
                        [22.897294168558627, 59.82886684313983],
                        [22.888120113221483, 59.83089172132356],
                        [22.873783198907162, 59.834112204382095],
                        [22.86107280697468, 59.825136755758514],
                        [22.853228930476277, 59.81958422385451],
                        [22.848583057185422, 59.81626197280768],
                        [22.849681602375092, 59.81441417667188],
                        [22.854307367461868, 59.806364723690336],
                        [22.85930679185699, 59.79771845477634],
                        [22.860016093620484, 59.79650278902606],
                        [22.860015974772004, 59.79650274032374],
                        [22.86002078270863, 59.796478525876665],
                        [22.86000772595114, 59.79645406295302],
                        [22.859978617328473, 59.7964294086948],
                        [22.859938630584306, 59.79640729765965],
                        [22.85989480331301, 59.79639054114861],
                        [22.859858653919208, 59.79636310242272],
                        [22.859817480167774, 59.796329283414195],
                        [22.859807686335675, 59.79631116318969],
                        [22.85980357042291, 59.79628682925739],
                        [22.859823910286703, 59.7962736061322],
                        [22.859854143040256, 59.79627669912772],
                        [22.859875573219675, 59.79627697011835],
                        [22.859904202432183, 59.79627645205511],
                        [22.859914771149132, 59.79627927578157],
                        [22.85995788305191, 59.796275348077],
                        [22.85997238805375, 59.79627104003123],
                        [22.859994509524125, 59.79625783708076],
                        [22.86001306872549, 59.79624458476746],
                        [22.860052680722227, 59.796238811409616],
                        [22.86010113760174, 59.79623494425988],
                        [22.860145674893584, 59.79623821838224],
                        [22.86017002856535, 59.796238941128806],
                        [22.862661744596515, 59.791967561439286],
                        [22.865935654043188, 59.78625208479987],
                        [22.87072870283496, 59.77782169506897],
                        [22.870844983405714, 59.77780095063983],
                        [22.871447590885463, 59.776717360759115],
                        [22.91477304781222, 59.7831181537036],
                        [22.928740317427955, 59.763929432986096],
                        [22.97843449869108, 59.76408003271157],
                        [22.977999931128632, 59.73977121548818],
                        [22.73879124132729, 59.73692168223259],
                        [22.773363319391073, 59.792521830675796],
                        [22.810169708875073, 59.85043036231866],
                        [22.81064210397763, 59.8538859461246],
                        [22.85690598945119, 59.85748819800857],
                        [22.897294168558627, 59.82886684313983],
                    ]
                ]
            },
        }
    ],
}

valtion_query_response = {
    "displayFieldName": "LsAlueTunnus",
    "fieldAliases": {
        "OBJECTID": "OBJECTID",
        "KohdeId": "KohdeId",
        "LsAlueTunnus": "LsAlueTunnus",
        "Nimi": "Nimi",
        "NimiRuotsi": "NimiRuotsi",
        "KohdeTyyppi": "KohdeTyyppi",
        "TyyppiLyhenne": "TyyppiLyhenne",
        "TyyppiNimi": "TyyppiNimi",
        "PaatPvm": "PaatPvm",
        "PaatNimi": "PaatNimi",
        "PaatURL": "PaatURL",
        "ViimPaatPvm": "ViimPaatPvm",
        "ViimPaatNimi": "ViimPaatNimi",
        "VoimaantuloPvm": "VoimaantuloPvm",
        "LakiPeruste": "LakiPeruste",
        "LakkautusPvm": "LakkautusPvm",
        "CDDATunnus": "CDDATunnus",
        "IUCNKategoria": "IUCNKategoria",
        "IUCNLuokkaNimi": "IUCNLuokkaNimi",
        "LPAlue": "LPAlue",
        "ELY": "ELY",
        "Olotila": "Olotila",
        "OlotilaMuutosPvm": "OlotilaMuutosPvm",
        "DigPohja": "DigPohja",
        "MuutosPvm": "MuutosPvm",
        "Lisatieto": "Lisatieto",
        "Shape.STArea()": "Shape.STArea()",
        "Shape.STLength()": "Shape.STLength()",
    },
    "geometryType": "esriGeometryPolygon",
    "spatialReference": {"wkid": 4326, "latestWkid": 4326},
    "fields": [
        {"name": "OBJECTID", "type": "esriFieldTypeOID", "alias": "OBJECTID"},
        {"name": "KohdeId", "type": "esriFieldTypeInteger", "alias": "KohdeId"},
        {
            "name": "LsAlueTunnus",
            "type": "esriFieldTypeString",
            "alias": "LsAlueTunnus",
            "length": 50,
        },
        {"name": "Nimi", "type": "esriFieldTypeString", "alias": "Nimi", "length": 200},
        {
            "name": "NimiRuotsi",
            "type": "esriFieldTypeString",
            "alias": "NimiRuotsi",
            "length": 200,
        },
        {"name": "KohdeTyyppi", "type": "esriFieldTypeInteger", "alias": "KohdeTyyppi"},
        {
            "name": "TyyppiLyhenne",
            "type": "esriFieldTypeString",
            "alias": "TyyppiLyhenne",
            "length": 4,
        },
        {
            "name": "TyyppiNimi",
            "type": "esriFieldTypeString",
            "alias": "TyyppiNimi",
            "length": 60,
        },
        {
            "name": "PaatPvm",
            "type": "esriFieldTypeDate",
            "alias": "PaatPvm",
            "length": 8,
        },
        {
            "name": "PaatNimi",
            "type": "esriFieldTypeString",
            "alias": "PaatNimi",
            "length": 200,
        },
        {
            "name": "PaatURL",
            "type": "esriFieldTypeString",
            "alias": "PaatURL",
            "length": 255,
        },
        {
            "name": "ViimPaatPvm",
            "type": "esriFieldTypeDate",
            "alias": "ViimPaatPvm",
            "length": 8,
        },
        {
            "name": "ViimPaatNimi",
            "type": "esriFieldTypeString",
            "alias": "ViimPaatNimi",
            "length": 200,
        },
        {
            "name": "VoimaantuloPvm",
            "type": "esriFieldTypeDate",
            "alias": "VoimaantuloPvm",
            "length": 8,
        },
        {
            "name": "LakiPeruste",
            "type": "esriFieldTypeString",
            "alias": "LakiPeruste",
            "length": 255,
        },
        {
            "name": "LakkautusPvm",
            "type": "esriFieldTypeDate",
            "alias": "LakkautusPvm",
            "length": 8,
        },
        {"name": "CDDATunnus", "type": "esriFieldTypeInteger", "alias": "CDDATunnus"},
        {
            "name": "IUCNKategoria",
            "type": "esriFieldTypeString",
            "alias": "IUCNKategoria",
            "length": 4,
        },
        {
            "name": "IUCNLuokkaNimi",
            "type": "esriFieldTypeString",
            "alias": "IUCNLuokkaNimi",
            "length": 50,
        },
        {
            "name": "LPAlue",
            "type": "esriFieldTypeString",
            "alias": "LPAlue",
            "length": 30,
        },
        {"name": "ELY", "type": "esriFieldTypeString", "alias": "ELY", "length": 50},
        {
            "name": "Olotila",
            "type": "esriFieldTypeString",
            "alias": "Olotila",
            "length": 50,
        },
        {
            "name": "OlotilaMuutosPvm",
            "type": "esriFieldTypeDate",
            "alias": "OlotilaMuutosPvm",
            "length": 8,
        },
        {
            "name": "DigPohja",
            "type": "esriFieldTypeString",
            "alias": "DigPohja",
            "length": 100,
        },
        {
            "name": "MuutosPvm",
            "type": "esriFieldTypeDate",
            "alias": "MuutosPvm",
            "length": 8,
        },
        {
            "name": "Lisatieto",
            "type": "esriFieldTypeString",
            "alias": "Lisatieto",
            "length": 255,
        },
        {
            "name": "Shape.STArea()",
            "type": "esriFieldTypeDouble",
            "alias": "Shape.STArea()",
        },
        {
            "name": "Shape.STLength()",
            "type": "esriFieldTypeDouble",
            "alias": "Shape.STLength()",
        },
    ],
    "features": [
        {
            "attributes": {
                "OBJECTID": 23,
                "KohdeId": 840,
                "LsAlueTunnus": "ESA040011",
                "Nimi": "Vehoniemenharjun luonnonsuojelualue",
                "NimiRuotsi": "",
                "KohdeTyyppi": 203,
                "TyyppiLyhenne": "ESA",
                "TyyppiNimi": "Muu luonnonsuojelualue (MH)",
                "PaatPvm": 425692800000,
                "PaatNimi": "Asetus Vehoniemenharjun luonnonsuojelualueesta",
                "PaatURL": "",
                "ViimPaatPvm": 425692800000,
                "ViimPaatNimi": "Asetus Vehoniemenharjun luonnonsuojelualueesta",
                "VoimaantuloPvm": 426297600000,
                "LakiPeruste": "",
                "LakkautusPvm": 253402214400000,
                "CDDATunnus": 101988,
                "IUCNKategoria": "V",
                "IUCNLuokkaNimi": "Suojeltu maisema-alue",
                "LPAlue": "<määrittelemätön>",
                "ELY": "Pirkanmaan ELY-keskus",
                "Olotila": "Voimassa",
                "OlotilaMuutosPvm": 253402214400000,
                "DigPohja": "SuMaVe-konversio/ KihtiGis_ei tuottamistietoa",
                "MuutosPvm": 1648736659000,
                "Lisatieto": "",
                "Shape.STArea()": 1014952.96484375,
                "Shape.STLength()": 16991.43951023576,
            },
            "geometry": {
                "rings": [
                    [
                        [24.14769529714196, 61.412568745034484],
                        [24.14759034962984, 61.41216129482983],
                        [24.147395861281836, 61.41219938485134],
                        [24.147840526649393, 61.41160738688169],
                        [24.14795129880444, 61.4115191746305],
                        [24.148185659957527, 61.4113325079988],
                        [24.14855920334931, 61.41114697970431],
                        [24.14876752186022, 61.41105624787557],
                        [24.149144171013894, 61.4109187813995],
                        [24.150132640130977, 61.410589796404174],
                        [24.15104085755094, 61.410295632306095],
                        [24.151836271913048, 61.41008481106761],
                        [24.152338659248546, 61.409959742538504],
                        [24.153003315202454, 61.409804317818804],
                        [24.153962576214756, 61.409567151596],
                        [24.154129616985685, 61.40952042922403],
                        [24.154639560374864, 61.40940747637364],
                        [24.1549634772237, 61.4093331943507],
                        [24.155378622748827, 61.40923185695734],
                        [24.155643733408237, 61.40917040259738],
                        [24.155917611673722, 61.409120926195435],
                        [24.15639488910259, 61.409023858279575],
                        [24.15647951642427, 61.408999521657066],
                        [24.156218157510214, 61.40880208375681],
                        [24.158660339050027, 61.40788300445185],
                        [24.158754471143542, 61.407956918273975],
                        [24.15876908936587, 61.40794888705644],
                        [24.15904439927488, 61.40779916234987],
                        [24.159431573721605, 61.40759876241607],
                        [24.160209060637097, 61.407220393484685],
                        [24.16055501222298, 61.40706284289332],
                        [24.161005101534805, 61.40683603842086],
                        [24.161790261858837, 61.406453024024934],
                        [24.16245896960707, 61.40612423403229],
                        [24.163250579868894, 61.4057329378489],
                        [24.164614025291662, 61.405047864859945],
                        [24.164860115168008, 61.4049415832288],
                        [24.165069970082744, 61.40485832483462],
                        [24.16556859289498, 61.40470626178482],
                        [24.166009161415065, 61.4045766405007],
                        [24.166279577681, 61.40446673093563],
                        [24.167242497309836, 61.40420894326675],
                        [24.168204717377524, 61.40390326236142],
                        [24.166692768289238, 61.40326676745938],
                        [24.167334823533277, 61.40306385809651],
                        [24.16667977684591, 61.4027861676497],
                        [24.166604453453743, 61.40275424391491],
                        [24.166563987854545, 61.402780377857155],
                        [24.166476720931186, 61.40280082954216],
                        [24.1663801957383, 61.40280744262598],
                        [24.166250899340813, 61.40282352403682],
                        [24.16617809998288, 61.40284582208649],
                        [24.16617798450823, 61.40284585561391],
                        [24.166154469531797, 61.402863808445154],
                        [24.166058911325333, 61.40290687781268],
                        [24.165939383385982, 61.40294914224058],
                        [24.165882348414808, 61.40296931616508],
                        [24.16571945549646, 61.40301904028387],
                        [24.165577041778, 61.40304915816867],
                        [24.165456129420278, 61.40309572330169],
                        [24.16532924115478, 61.40313916335808],
                        [24.165214941871742, 61.40315784711203],
                        [24.165100682287047, 61.403152537131675],
                        [24.16505102392862, 61.40317153493523],
                        [24.165044248156903, 61.403201407005845],
                        [24.165012514599507, 61.40325376518101],
                        [24.16493040681413, 61.4032861095658],
                        [24.164756961363306, 61.40336061322523],
                        [24.164601321663174, 61.403422471012775],
                        [24.164419573773344, 61.40347279773193],
                        [24.164119687433235, 61.40358574535987],
                        [24.163972894330612, 61.40364177706001],
                        [24.163855370562462, 61.403697412788084],
                        [24.163679867953615, 61.40374785979778],
                        [24.16353724356897, 61.40380398696171],
                        [24.163432219123628, 61.40383586156609],
                        [24.163388118320754, 61.40386297884229],
                        [24.16335927204267, 61.40390640457458],
                        [24.16331002265559, 61.40394441005472],
                        [24.163180397920488, 61.404001409861216],
                        [24.1629868082394, 61.4040914995445],
                        [24.162866499165723, 61.40415507153952],
                        [24.162658793725086, 61.40428689039568],
                        [24.162513449480787, 61.40437396130549],
                        [24.16236559966007, 61.40444197105684],
                        [24.162223036750266, 61.40452109554727],
                        [24.16203311657168, 61.40464025873023],
                        [24.161870251156863, 61.404736979851975],
                        [24.16170205990173, 61.404822585067606],
                        [24.16157800821434, 61.40488108316328],
                        [24.16145635202275, 61.40495962805984],
                        [24.161286173378965, 61.40504418518499],
                        [24.16101781850608, 61.4051777723259],
                        [24.160914221375286, 61.405240685376405],
                        [24.160756578862895, 61.405301500044345],
                        [24.16063512521429, 61.405354050686945],
                        [24.160517980693808, 61.40542868240823],
                        [24.160317328504547, 61.40552763138259],
                        [24.159799696490687, 61.40576717187957],
                        [24.159503282543277, 61.40591117492141],
                        [24.15928864124006, 61.40602684480062],
                        [24.159108548056047, 61.40612921290583],
                        [24.15893559070896, 61.40622172237938],
                        [24.15869577241926, 61.40633886880741],
                        [24.15853889948653, 61.40639069579817],
                        [24.158407653784863, 61.40643604198029],
                        [24.158302496758367, 61.40649291970427],
                        [24.158171893278393, 61.406554278438485],
                        [24.15806171263057, 61.40662104950682],
                        [24.157933547355686, 61.40667846137423],
                        [24.15778864190915, 61.40673652948282],
                        [24.157578288267512, 61.40680327322984],
                        [24.15741676783148, 61.40684907285444],
                        [24.15740712939359, 61.40685180899312],
                        [24.157234899065084, 61.406912323921226],
                        [24.15709355551064, 61.40695346026591],
                        [24.156931064412102, 61.40699817002851],
                        [24.156788005869167, 61.40703528161074],
                        [24.156646154473858, 61.40708239879232],
                        [24.156538192860236, 61.407100210855425],
                        [24.156380752353144, 61.4071110235403],
                        [24.1562157769561, 61.407136671748674],
                        [24.156053355534276, 61.40718038479749],
                        [24.155785472884222, 61.40726096122867],
                        [24.155508173400097, 61.40735335099165],
                        [24.155300675449503, 61.40743515327804],
                        [24.155159091820792, 61.407479283105104],
                        [24.15510047907137, 61.40750508822668],
                        [24.155044438613658, 61.407548958770505],
                        [24.154962969337042, 61.407597310166686],
                        [24.15484341016091, 61.40765189881074],
                        [24.15469719864053, 61.40770093511815],
                        [24.154585812733576, 61.407733676274866],
                        [24.154500280019715, 61.40778094525827],
                        [24.154445534013657, 61.40783384398591],
                        [24.154327068829637, 61.40789945072874],
                        [24.154194121248715, 61.407963757241404],
                        [24.153980004389425, 61.40804941674501],
                        [24.153752729949474, 61.408118810222916],
                        [24.153349727227518, 61.40824064515534],
                        [24.15306698308674, 61.40832390590221],
                        [24.152685909888174, 61.408457193547704],
                        [24.152345443171804, 61.40860329608727],
                        [24.15189386809824, 61.40875512965788],
                        [24.151689318823227, 61.40882698993377],
                        [24.15140580418213, 61.4089422390123],
                        [24.151128717165527, 61.40905562783033],
                        [24.15085614578568, 61.4091651041022],
                        [24.150500815831506, 61.40931390037986],
                        [24.150262322581234, 61.40939205461175],
                        [24.150020255154946, 61.40946314448769],
                        [24.14979188784369, 61.40954451052273],
                        [24.149578605756183, 61.40964418600809],
                        [24.14938497534481, 61.40971026187978],
                        [24.149255233498284, 61.40976162304538],
                        [24.149142960760706, 61.409804348838364],
                        [24.14899267117154, 61.409899306733756],
                        [24.148811813388384, 61.410009632191255],
                        [24.14853769807751, 61.41016008086413],
                        [24.14833326073544, 61.4102539390011],
                        [24.14808083890641, 61.41039481609948],
                        [24.147813475317264, 61.41053939506361],
                        [24.147573144300555, 61.410661524904775],
                        [24.14734693086042, 61.410788936173454],
                        [24.14712412339685, 61.410925419881345],
                        [24.14701698197294, 61.41100424809589],
                        [24.14691565132743, 61.41108820185308],
                        [24.14685449227504, 61.411165964073],
                        [24.146762872173014, 61.41125810762868],
                        [24.146589759363888, 61.41139859733437],
                        [24.14645294440427, 61.41152296842171],
                        [24.146294458016104, 61.4116867620904],
                        [24.146163352421816, 61.41187111805259],
                        [24.146105396218722, 61.41195995183158],
                        [24.146034139608975, 61.412104509074105],
                        [24.14593981512552, 61.41225062157093],
                        [24.145849136771215, 61.41235578332296],
                        [24.145789010180017, 61.41249256975874],
                        [24.14568103765469, 61.41265139474314],
                        [24.14555803225247, 61.41281491697494],
                        [24.1455182739012, 61.412910115313935],
                        [24.145416531951728, 61.41302205173354],
                        [24.14535565436262, 61.41314383794378],
                        [24.145323948049636, 61.41326620031469],
                        [24.145251022593406, 61.41347675020252],
                        [24.14515056834559, 61.413644724985204],
                        [24.144992110096368, 61.41397253689487],
                        [24.144891796999516, 61.41416252381778],
                        [24.14479749683241, 61.41433162469543],
                        [24.144703614201166, 61.41451973417834],
                        [24.14461153636131, 61.41466388078281],
                        [24.14454709082782, 61.41491959723479],
                        [24.14452211573992, 61.41510711362827],
                        [24.14448287544116, 61.415267335486675],
                        [24.14444080886378, 61.41543550222795],
                        [24.14440186477207, 61.415521716033254],
                        [24.144322575544788, 61.41563911781855],
                        [24.144237453638038, 61.41577540601639],
                        [24.1441845862309, 61.41587733594141],
                        [24.144122862280003, 61.41598508983936],
                        [24.14399536524476, 61.4162225219064],
                        [24.143936773823253, 61.41631834864877],
                        [24.14386200034076, 61.416431838407625],
                        [24.143753859721798, 61.4165686582521],
                        [24.143604861663928, 61.41674264700169],
                        [24.143464920052658, 61.416908812555526],
                        [24.143351055191637, 61.41703951102534],
                        [24.14320714045495, 61.4171795949512],
                        [24.143097851173867, 61.417282379048515],
                        [24.14294573670724, 61.41739729871273],
                        [24.14277561636674, 61.41752684238714],
                        [24.142593939572553, 61.417669160124454],
                        [24.142461010127835, 61.417779469465266],
                        [24.142312130584067, 61.41792844964529],
                        [24.14220180970866, 61.41806621977551],
                        [24.14208173633136, 61.41821979341421],
                        [24.141920750066674, 61.41838752781167],
                        [24.141744635057023, 61.418560963113585],
                        [24.14163664572441, 61.41866725903525],
                        [24.141648018885558, 61.41867205255155],
                        [24.141731009826227, 61.41870699867854],
                        [24.141773939717986, 61.418725085776536],
                        [24.143489432495002, 61.41944753402776],
                        [24.14373238036572, 61.41937481104802],
                        [24.14503867608123, 61.41871514972662],
                        [24.145351781107255, 61.41853134311142],
                        [24.145808931520303, 61.4181172768339],
                        [24.146180888964533, 61.41772155406674],
                        [24.1463867964323, 61.417352801528466],
                        [24.146464761142333, 61.417140470279065],
                        [24.14650140347489, 61.417040624789415],
                        [24.14654702838306, 61.416916326236795],
                        [24.146557373160284, 61.41666165740967],
                        [24.146418093119056, 61.41627790327563],
                        [24.14649705258316, 61.41618436232824],
                        [24.14643104271243, 61.41575561986688],
                        [24.14647253414324, 61.41569133355195],
                        [24.14663527562824, 61.415235273155915],
                        [24.147124172443277, 61.4146931011448],
                        [24.1479891013933, 61.41413016298963],
                        [24.148721762379502, 61.41355576078189],
                        [24.14799124892815, 61.4129418493396],
                        [24.14769529714196, 61.412568745034484],
                    ],
                    [
                        [24.20039870944956, 61.385825496624975],
                        [24.200881099784723, 61.385638642641176],
                        [24.201547500884296, 61.385841690125346],
                        [24.20432848065199, 61.383696709206056],
                        [24.195942280009177, 61.381241469353036],
                        [24.19546658070303, 61.38159496536694],
                        [24.194858017239373, 61.38204963643222],
                        [24.193427185482406, 61.381663435960384],
                        [24.192903110321232, 61.382258696670256],
                        [24.192541470725846, 61.3826302587761],
                        [24.192091546626166, 61.38306124439348],
                        [24.193500137051572, 61.38354831190979],
                        [24.19238944992641, 61.38428181301666],
                        [24.19135965521185, 61.38495688794998],
                        [24.190501634352135, 61.38552934135007],
                        [24.194113081559646, 61.38597909461631],
                        [24.197641805097255, 61.38642238314427],
                        [24.1980035297688, 61.38646324661663],
                        [24.20039870944956, 61.385825496624975],
                    ],
                    [
                        [24.16035295373589, 61.40924823379974],
                        [24.1604937256314, 61.40917240636037],
                        [24.160566074559853, 61.40913341064559],
                        [24.160647688758807, 61.4091364257338],
                        [24.160649613189225, 61.409136492851545],
                        [24.161281495283724, 61.40915981356185],
                        [24.161356996274495, 61.409150070080464],
                        [24.16297331844001, 61.408189846077455],
                        [24.162968920063168, 61.408186888662726],
                        [24.162927621069002, 61.40815912225078],
                        [24.162383126903006, 61.407800684975236],
                        [24.162476914619276, 61.40758578371042],
                        [24.162550163891638, 61.40741645763034],
                        [24.1629439898139, 61.407110066726005],
                        [24.163440717584308, 61.40679727749537],
                        [24.163926671604017, 61.40649715303379],
                        [24.164542038988483, 61.406139437572314],
                        [24.164848246327544, 61.40598309624501],
                        [24.16543066603267, 61.4056687624887],
                        [24.16572069862217, 61.40546129054876],
                        [24.16589909513746, 61.40532278371427],
                        [24.16749179868923, 61.40431664368595],
                        [24.166422529835568, 61.404590525699064],
                        [24.166012232403137, 61.40469550892036],
                        [24.16549385706209, 61.404858966031725],
                        [24.16509039418229, 61.404997614760916],
                        [24.164958657035307, 61.405045867402805],
                        [24.16475784559744, 61.40514076789211],
                        [24.164264327122854, 61.40539074501847],
                        [24.163374528213232, 61.40582445772038],
                        [24.162660065244793, 61.40618076577231],
                        [24.16229334654933, 61.40635941227235],
                        [24.16151492228662, 61.4067364523618],
                        [24.161461422021087, 61.406755979659096],
                        [24.16097507493712, 61.40698027709043],
                        [24.16037754181833, 61.407291025264556],
                        [24.159824799962927, 61.40754557211972],
                        [24.159492354235734, 61.40770475050568],
                        [24.15882546128804, 61.4079965622962],
                        [24.158813738791203, 61.40800345921631],
                        [24.159084278508054, 61.40821587931338],
                        [24.156664429184406, 61.409139242126905],
                        [24.156599997527906, 61.40909055307636],
                        [24.156504731719238, 61.409124486209315],
                        [24.156497262033177, 61.409126243525044],
                        [24.156206026558475, 61.4091948970318],
                        [24.155883000251457, 61.409270359423566],
                        [24.155416136515797, 61.40935303643288],
                        [24.15490819486841, 61.40945969175229],
                        [24.15432745736009, 61.409604555865755],
                        [24.154195391213175, 61.409644284454004],
                        [24.153395843840713, 61.40983411933071],
                        [24.152820265030208, 61.409976515911275],
                        [24.152225931053078, 61.41010026329205],
                        [24.151502375700296, 61.410277646135484],
                        [24.150649920453017, 61.41054433321942],
                        [24.14977705012842, 61.410832668594324],
                        [24.149097051913266, 61.411066864271056],
                        [24.148706269519312, 61.41122197424595],
                        [24.148627633173117, 61.411273983827805],
                        [24.14827553742919, 61.41151881211177],
                        [24.14815553062539, 61.41160224051206],
                        [24.147976644465093, 61.411891869927764],
                        [24.147924664219914, 61.412258030185264],
                        [24.1482470378483, 61.41276226142955],
                        [24.148764745541904, 61.41320451288947],
                        [24.149161288562482, 61.413306825239836],
                        [24.150094772718443, 61.412881930557475],
                        [24.150424050586157, 61.412601611407986],
                        [24.15122017664269, 61.41224799008393],
                        [24.152967367456117, 61.41151364000607],
                        [24.154158225636483, 61.411013093027755],
                        [24.156162889341083, 61.41044947347442],
                        [24.157734639233503, 61.41003933469082],
                        [24.158724780602448, 61.409856141589884],
                        [24.15948461824689, 61.409715546795695],
                        [24.160548946728074, 61.40940833861841],
                        [24.16035295373589, 61.40924823379974],
                    ],
                    [
                        [24.13594499934153, 61.42510258234765],
                        [24.136558234383838, 61.42463424546022],
                        [24.136905355750407, 61.424256528701065],
                        [24.13705414913957, 61.424068815374476],
                        [24.13781388852096, 61.4235632829179],
                        [24.140597013474057, 61.42132007332466],
                        [24.140979384338184, 61.42094079727572],
                        [24.14154699049224, 61.42049970711945],
                        [24.141557628195148, 61.42049144127154],
                        [24.14152593294745, 61.42048578963072],
                        [24.141214771416035, 61.420417428572684],
                        [24.14085136555194, 61.420326013522214],
                        [24.140609636591208, 61.42027507353052],
                        [24.140536398383027, 61.42025358226187],
                        [24.14040305486362, 61.42025086078705],
                        [24.14026449758717, 61.420260031444876],
                        [24.14012610377091, 61.42026721108004],
                        [24.14003390873128, 61.42027132808289],
                        [24.139937539659844, 61.42027536627007],
                        [24.139880894225275, 61.4203022128301],
                        [24.13976740125404, 61.42035790493719],
                        [24.139636375207782, 61.4204232359054],
                        [24.139521638641007, 61.420492906826055],
                        [24.139385031096385, 61.42057412868135],
                        [24.13923537162586, 61.420661094887535],
                        [24.138985796542855, 61.420792018095014],
                        [24.13881085842191, 61.42088145280349],
                        [24.13861570986759, 61.42096348217573],
                        [24.138427451605477, 61.42103864911938],
                        [24.138192992195748, 61.42111687766901],
                        [24.13797218588784, 61.42118237602649],
                        [24.137757812499444, 61.4212460060537],
                        [24.137555799729054, 61.421287895373844],
                        [24.137277898434522, 61.421338222305955],
                        [24.137054963193865, 61.421380676858924],
                        [24.136957727715245, 61.42140619210512],
                        [24.13687470573223, 61.42143599500377],
                        [24.13678992519784, 61.421462275279566],
                        [24.136652090855552, 61.42149846175297],
                        [24.136524039837866, 61.42154185206653],
                        [24.136415862664755, 61.42158464538438],
                        [24.136228657026507, 61.4216713393412],
                        [24.13614050497356, 61.42172353733795],
                        [24.136042706057296, 61.42179055253567],
                        [24.135869575792988, 61.42190653181925],
                        [24.135744950507274, 61.42196999066774],
                        [24.135610357981648, 61.42205175444767],
                        [24.135497126675688, 61.422127948891884],
                        [24.135405667925795, 61.42217058134602],
                        [24.135334974700363, 61.4222141450031],
                        [24.13522224545599, 61.422284851943445],
                        [24.135116370604276, 61.422348696032145],
                        [24.135047772653685, 61.42239230366542],
                        [24.134987128892483, 61.42244057046141],
                        [24.134912358423854, 61.42249504379381],
                        [24.134817588999052, 61.422586619798246],
                        [24.13472651560851, 61.42268327734534],
                        [24.134648284313513, 61.42275318308391],
                        [24.134493169198496, 61.42288953724219],
                        [24.134362417907386, 61.422986374134574],
                        [24.134304151557053, 61.42307818852919],
                        [24.13422684100365, 61.42316113044352],
                        [24.13414224543882, 61.423255408707625],
                        [24.134010873371032, 61.423371241179495],
                        [24.133883623766412, 61.42347565258228],
                        [24.133716956696574, 61.42358925911415],
                        [24.13348851347124, 61.42374011206575],
                        [24.13326354817864, 61.42387552353052],
                        [24.13304361374467, 61.424001051056074],
                        [24.132970165988482, 61.42407555741156],
                        [24.13289102065878, 61.42415635786373],
                        [24.133098870310985, 61.42423602727489],
                        [24.133692192198055, 61.42446343701751],
                        [24.132755930066445, 61.42502398014544],
                        [24.132170865896494, 61.42479972292376],
                        [24.132053862218843, 61.424754864168094],
                        [24.132026418407925, 61.42474434109468],
                        [24.131920137735193, 61.42482877338804],
                        [24.13174249974759, 61.42494814740979],
                        [24.131668973098563, 61.42502365761708],
                        [24.131526490172206, 61.425146754893596],
                        [24.131402027218627, 61.42527822717038],
                        [24.13130037634054, 61.42538816181534],
                        [24.131195931976087, 61.425506041755284],
                        [24.131126626550152, 61.42562763595236],
                        [24.13106326622759, 61.42577636868927],
                        [24.131012367129365, 61.425902339540556],
                        [24.130982778493017, 61.42609375491972],
                        [24.13096963927282, 61.42626452277586],
                        [24.13095966694002, 61.42637632715448],
                        [24.13094180970187, 61.42643596909274],
                        [24.13096157474408, 61.42649538010635],
                        [24.1309320876746, 61.426591788662336],
                        [24.130881736945508, 61.426711770098294],
                        [24.130864911700595, 61.42685345267506],
                        [24.130779772970474, 61.42698872710137],
                        [24.130692090960107, 61.42710595401053],
                        [24.13066234679026, 61.427205348590206],
                        [24.130543292146303, 61.4273229380445],
                        [24.130424482238823, 61.4274615268898],
                        [24.130334316523076, 61.4275826898815],
                        [24.130270716871898, 61.42775740640724],
                        [24.130223288512262, 61.427891454473674],
                        [24.130163107963, 61.42807425629992],
                        [24.13015666966945, 61.428095537075414],
                        [24.130240117173617, 61.42816727786885],
                        [24.13102672541477, 61.42884270006301],
                        [24.131133845409103, 61.42873686044206],
                        [24.131394822686154, 61.42866682892344],
                        [24.13200374899283, 61.428169960334294],
                        [24.13274633421563, 61.42750809476556],
                        [24.133292335425125, 61.42719362446407],
                        [24.133458448147795, 61.42708404007662],
                        [24.133982795090187, 61.42657726980177],
                        [24.134891202309323, 61.425945934962904],
                        [24.13594499934153, 61.42510258234765],
                    ],
                    [
                        [24.15124013535565, 61.41323468393161],
                        [24.15131954765832, 61.413186300406885],
                        [24.151447024382076, 61.413136875029956],
                        [24.15157587192805, 61.41311949498772],
                        [24.151794497401315, 61.413053930091365],
                        [24.151997524022516, 61.412976045501885],
                        [24.152250694449183, 61.41292118360023],
                        [24.152577006516033, 61.412817796788374],
                        [24.152685659159538, 61.4127689914267],
                        [24.152839960224746, 61.412770127650376],
                        [24.15293729983421, 61.4127592736347],
                        [24.152991688938364, 61.41275320719547],
                        [24.153130878060388, 61.41271302674545],
                        [24.15330707610569, 61.412702609899256],
                        [24.153444633906958, 61.412704401226236],
                        [24.15358274965696, 61.412676199643776],
                        [24.15379047963235, 61.41263941096488],
                        [24.153951718602222, 61.412612528237176],
                        [24.154004386148525, 61.41260374834149],
                        [24.15416953298158, 61.41255309628092],
                        [24.15429357968491, 61.41253343033594],
                        [24.15430686251785, 61.412524661934825],
                        [24.15433157610599, 61.412511200768726],
                        [24.154358773581002, 61.41249886955813],
                        [24.154387933528934, 61.41248763044504],
                        [24.154399817979993, 61.412483513117685],
                        [24.15443120626452, 61.412473739977116],
                        [24.15445312531332, 61.412467910096275],
                        [24.15446335299223, 61.412463048423845],
                        [24.154687575588806, 61.41238159673317],
                        [24.15495910295136, 61.41233109348794],
                        [24.155112881787147, 61.41229120720204],
                        [24.155305140201936, 61.41225773997679],
                        [24.155320313244452, 61.41225105921332],
                        [24.155350552661634, 61.412240516226035],
                        [24.15538356200801, 61.412232079357],
                        [24.155394805444182, 61.412229853014594],
                        [24.155430561601726, 61.412224599778604],
                        [24.15546736079921, 61.4122212728147],
                        [24.15550446962451, 61.41221886861752],
                        [24.155516955503888, 61.41221823134776],
                        [24.15556525786815, 61.41220138236994],
                        [24.15574559332082, 61.41214403003029],
                        [24.155840098502612, 61.41208994070354],
                        [24.155962505373676, 61.41200341180139],
                        [24.156145336840094, 61.411894106488546],
                        [24.156297107195954, 61.411853179776955],
                        [24.156479788545045, 61.41179287510719],
                        [24.156540920797635, 61.411767885548684],
                        [24.15663131408662, 61.4117309398358],
                        [24.156678064056898, 61.411713420217126],
                        [24.156822467493953, 61.411659295138826],
                        [24.156836324192124, 61.41165409590728],
                        [24.157015501932097, 61.41160137114224],
                        [24.15701695807539, 61.411601024272066],
                        [24.157040415337192, 61.41159413914975],
                        [24.157158043901262, 61.411578612622186],
                        [24.157329564960218, 61.41155008132125],
                        [24.157390097357272, 61.41152837575287],
                        [24.157435147808638, 61.41151222177492],
                        [24.157465413602157, 61.41149786994772],
                        [24.157520107219707, 61.41147193693211],
                        [24.15764580613399, 61.4114424837412],
                        [24.157840289279353, 61.41143742894657],
                        [24.157858475097765, 61.41143779990247],
                        [24.15801101734797, 61.41144088791159],
                        [24.158042318894587, 61.41144152385781],
                        [24.158228295511528, 61.411438285105525],
                        [24.15837725775454, 61.41140530164618],
                        [24.15852658252825, 61.411368328010994],
                        [24.158698481937925, 61.41133581431517],
                        [24.158840233169546, 61.41131368435275],
                        [24.159043333900144, 61.411274859768696],
                        [24.159067312240154, 61.41127027594148],
                        [24.159218251081, 61.4112623335094],
                        [24.159299179030985, 61.411219969110135],
                        [24.159428956862534, 61.411191596634715],
                        [24.159579468418226, 61.411164636133584],
                        [24.159720601260847, 61.411149499368875],
                        [24.159858704610098, 61.41112129133325],
                        [24.15998391903301, 61.41107382330283],
                        [24.16006520891758, 61.411027459455156],
                        [24.16017747059019, 61.41098473355833],
                        [24.160255170230606, 61.41096425651005],
                        [24.1602639637713, 61.410941128303854],
                        [24.160486925349122, 61.4102839527731],
                        [24.160494860607113, 61.410200753014294],
                        [24.160608200915313, 61.409784099850356],
                        [24.158742075598813, 61.41018808715234],
                        [24.158759445130606, 61.4102067040939],
                        [24.158517764459358, 61.410258853127495],
                        [24.15848412706696, 61.41024001313563],
                        [24.15830378073636, 61.4102793211083],
                        [24.156786671541933, 61.41062779692301],
                        [24.154719920315955, 61.411188608914536],
                        [24.153738332828237, 61.41151276704199],
                        [24.153277987206714, 61.41166480846356],
                        [24.152078749312945, 61.412168218211804],
                        [24.151403827631338, 61.412479222914506],
                        [24.15114983196924, 61.4126167579146],
                        [24.15088223766556, 61.412798556249655],
                        [24.150686040689777, 61.412918696319274],
                        [24.150517858741573, 61.413193694479894],
                        [24.150483201200583, 61.413183796535954],
                        [24.15038080258517, 61.41315452190392],
                        [24.150330945804953, 61.413140272014466],
                        [24.149527343602454, 61.41372957268463],
                        [24.148501223195687, 61.414197565031394],
                        [24.148162498916548, 61.4144228563479],
                        [24.148043310100768, 61.41450212466212],
                        [24.147884463433233, 61.41460777218534],
                        [24.14782802194038, 61.414645307344315],
                        [24.14733279504351, 61.41503398452728],
                        [24.14715673668122, 61.41518640623181],
                        [24.147151545369937, 61.41519090585476],
                        [24.14712062457902, 61.41521767478194],
                        [24.147138710419263, 61.41521998545658],
                        [24.147167283896774, 61.41520065046962],
                        [24.147200812865513, 61.41517796078189],
                        [24.14742598175265, 61.415025598532345],
                        [24.14755942680682, 61.41498097310939],
                        [24.147612720266366, 61.41496314448894],
                        [24.14768329554128, 61.41493343380768],
                        [24.14778732653877, 61.41488962883706],
                        [24.14781017479147, 61.41488001949206],
                        [24.14786199526549, 61.414858198223854],
                        [24.14809815098102, 61.4148070026088],
                        [24.148259604202593, 61.41479828631516],
                        [24.148406220586544, 61.41479520585355],
                        [24.148428947290373, 61.414794729964406],
                        [24.148565857049306, 61.414780513101356],
                        [24.148617398382275, 61.414762153291626],
                        [24.148680043026292, 61.414739830926024],
                        [24.14889285851939, 61.4146576012895],
                        [24.148893965937805, 61.41465717532789],
                        [24.149124949712345, 61.41454757641505],
                        [24.149146640846688, 61.4145372868207],
                        [24.149430343694775, 61.414444054883546],
                        [24.149620761771374, 61.41439091020206],
                        [24.14980860693797, 61.41431972663266],
                        [24.149937930953737, 61.414273350706225],
                        [24.150004739894744, 61.41422570101313],
                        [24.1500722532092, 61.41412306081028],
                        [24.150177321055295, 61.414044186736376],
                        [24.150277726896253, 61.41399422226659],
                        [24.150308861529304, 61.41397472470853],
                        [24.150401451461725, 61.41391672699824],
                        [24.150473265394993, 61.413836176995474],
                        [24.15049212102096, 61.41380784308551],
                        [24.150559922691787, 61.41370591839924],
                        [24.15061041557466, 61.413606937047746],
                        [24.150704109101156, 61.41351482543175],
                        [24.150796401128485, 61.41343869278545],
                        [24.150959174600054, 61.41341499881183],
                        [24.151076163917278, 61.413413379265364],
                        [24.15109509521447, 61.41341175444459],
                        [24.151180164418875, 61.413400842329814],
                        [24.151202754509104, 61.4133979466038],
                        [24.151271109033715, 61.413356329599516],
                        [24.151270903253263, 61.41332918651287],
                        [24.15127060712983, 61.41329131538387],
                        [24.15124013535565, 61.41323468393161],
                    ],
                    [
                        [24.169324627242837, 61.404371516825535],
                        [24.16851179883375, 61.40403325664747],
                        [24.16851171832953, 61.40403331785482],
                        [24.167546173359135, 61.40466270837316],
                        [24.16702160422821, 61.40495600386141],
                        [24.167021505826263, 61.40495605571184],
                        [24.16620514443678, 61.40542597335764],
                        [24.166205028139576, 61.405426015851404],
                        [24.16609700165363, 61.405463067281666],
                        [24.165811275079438, 61.40565449566246],
                        [24.165649077255125, 61.40576314700096],
                        [24.16504228912093, 61.40610068080149],
                        [24.164857036684417, 61.406203730271216],
                        [24.16468986514615, 61.40630516208839],
                        [24.163853868317005, 61.4068124321951],
                        [24.163021788518638, 61.4073369463721],
                        [24.16289031745423, 61.40734929635824],
                        [24.162877516626633, 61.40755595145294],
                        [24.162867670739033, 61.40771519126404],
                        [24.16326465507753, 61.4079153904053],
                        [24.163264690049484, 61.407915418084556],
                        [24.163345904958433, 61.40796471436956],
                        [24.163345944813788, 61.40796468825067],
                        [24.163459169977315, 61.40789733867623],
                        [24.164711619689935, 61.40715240176816],
                        [24.16483552517391, 61.407084393377815],
                        [24.16775906393049, 61.40536956472675],
                        [24.169526631795588, 61.404674828775455],
                        [24.16979494734056, 61.404569360327834],
                        [24.169792166645998, 61.40456819752227],
                        [24.169794713610344, 61.404567181504426],
                        [24.16979475264404, 61.404567164349984],
                        [24.169324627242837, 61.404371516825535],
                    ],
                    [
                        [24.13331457643176, 61.42948174314288],
                        [24.134005154958036, 61.42811947781163],
                        [24.13392941284854, 61.428147384284955],
                        [24.133622750677233, 61.428262049229204],
                        [24.132708901155546, 61.42863525778219],
                        [24.13234632993087, 61.42878351692412],
                        [24.131713140776586, 61.42889049739651],
                        [24.131357338152004, 61.42912973725868],
                        [24.131772739738764, 61.4294832413292],
                        [24.132849715137212, 61.43039967900655],
                        [24.13331457643176, 61.42948174314288],
                    ],
                    [
                        [24.134145628272467, 61.42718646105524],
                        [24.134046583337625, 61.42715913177113],
                        [24.133786040475552, 61.427372355264254],
                        [24.133645283579646, 61.42751911755323],
                        [24.13320069621001, 61.42774849650417],
                        [24.132453407050896, 61.42825945136103],
                        [24.132084429075427, 61.4285714237659],
                        [24.132136882380625, 61.42861761702912],
                        [24.13231015174018, 61.42862055856461],
                        [24.133353875196374, 61.428166326839694],
                        [24.133878971693424, 61.427999361965085],
                        [24.13403298843754, 61.42797745195654],
                        [24.13408024792456, 61.42797073044149],
                        [24.13435735498083, 61.42742542320794],
                        [24.13443778145629, 61.42726715774842],
                        [24.134145628272467, 61.42718646105524],
                    ],
                ]
            },
        }
    ],
}

changed_naturasci_query_response = copy.deepcopy(naturasci_query_response)
changed_naturasci_query_response["features"] = []


def mock_response(request: requests.PreparedRequest, context: object) -> str:
    if request.url == "http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer?f=json":  # type: ignore
        return json.dumps(kulttuuriymparisto_service_response)
    if request.url.startswith("http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer/1/query"):  # type: ignore
        return json.dumps(muinaisjaannokset_query_response)
    if request.url.startswith("http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer/7/query"):  # type: ignore
        return json.dumps(rkykohteet_query_response)
    if request.url == "http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer?f=json":  # type: ignore
        return json.dumps(suojellutalueet_service_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/2/query"):  # type: ignore
        return json.dumps(naturasac_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/3/query"):  # type: ignore
        return json.dumps(naturaspa_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/4/query"):  # type: ignore
        return json.dumps(naturasci_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/7/query"):  # type: ignore
        return json.dumps(valtion_query_response)
    raise NotImplementedError


def changed_mock_response(request: requests.PreparedRequest, context: object) -> str:
    if request.url == "http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer?f=json":  # type: ignore
        return json.dumps(kulttuuriymparisto_service_response)
    if request.url.startswith("http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer/1/query"):  # type: ignore
        return json.dumps(muinaisjaannokset_query_response)
    if request.url.startswith("http://mock.url/arcgis/rest/services/WFS/MV_KulttuuriymparistoSuojellut/MapServer/7/query"):  # type: ignore
        return json.dumps(rkykohteet_query_response)
    if request.url == "http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer?f=json":  # type: ignore
        return json.dumps(suojellutalueet_service_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/2/query"):  # type: ignore
        return json.dumps(naturasac_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/3/query"):  # type: ignore
        return json.dumps(naturaspa_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/4/query"):  # type: ignore
        return json.dumps(changed_naturasci_query_response)
    if request.url.startswith("http://anothermock.url/arcgis/rest/services/SYKE/SYKE_SuojellutAlueet/MapServer/7/query"):  # type: ignore
        return json.dumps(valtion_query_response)
    raise NotImplementedError


@pytest.fixture()
def mock_arcgis(requests_mock):
    requests_mock.get(ANY, text=mock_response)


@pytest.fixture()
def changed_mock_arcgis(requests_mock):
    requests_mock.get(ANY, text=changed_mock_response)


@pytest.fixture(scope="module")
def connection_string(tarmo_database_created):
    return DatabaseHelper().get_connection_string()


def test_get_arcgis_query_params(connection_string, metadata_set):
    loader = ArcGisLoader(
        connection_string, point_of_interest=Point(0, 0), point_radius=100
    )
    assert loader.get_arcgis_query_params() == {
        "inSR": 4326,
        "outSR": 4326,
        "units": "esriSRUnit_Meter",
        "distance": 100000,
        "geometry": '{"x": 0.0, "y": 0.0}',
        "geometryType": "esriGeometryPoint",
        "spatialRel": "esriSpatialRelIntersects",
        "outFields": "*",
        "f": "json",
    }


@pytest.fixture(scope="module")
def loader(connection_string):
    return ArcGisLoader(
        connection_string,
        point_of_interest=Point(23.7747, 61.4980),
        point_radius=10,
        url={
            "museovirastoarcrest_metadata": "http://mock.url/arcgis/rest/services",
            "syke_metadata": "http://anothermock.url/arcgis/rest/services",
        },
    )


@pytest.fixture(scope="module")
def metadata_set(main_db_params):
    conn = psycopg2.connect(**main_db_params)
    try:
        date = datetime.datetime(2011, 2, 3, 4, 5, 6, 7)
        with conn.cursor() as cur:
            cur.execute(
                f"UPDATE lipas.metadata SET last_modified = %(date)s",
                vars={"date": date},
            )
        conn.commit()
    finally:
        conn.close()


def test_get_geojson(loader, metadata_set):
    # Siikaneva should have one outer and one inner ring
    siikaneva = loader.get_geojson(
        "esriGeometryPolygon", naturasac_query_response["features"][0]
    )["geometry"]["coordinates"]
    assert len(siikaneva) == 1
    assert len(siikaneva[0]) == 2
    # Kaakkurijärvet should have six outer and zero inner rings
    kaakkurijarvet = loader.get_geojson(
        "esriGeometryPolygon", naturaspa_query_response["features"][0]
    )["geometry"]["coordinates"]
    assert len(kaakkurijarvet) == 6
    assert all([len(ring) == 1 for ring in kaakkurijarvet])


@pytest.fixture()
def arcgis_data(mock_arcgis, loader, metadata_set):
    data = loader.get_features()
    assert len(data["features"]) == 6
    return data


@pytest.fixture()
def changed_arcgis_data(changed_mock_arcgis, loader, metadata_set):
    data = loader.get_features()
    assert len(data["features"]) == 5
    return data


def test_get_muinaisjaannokset_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][0])
    assert feature["mjtunnus"]
    assert feature["name"] == "Särkänniemi 1"
    assert feature["type_name"] == "Alusten hylyt: hylyt (puu)"
    assert feature["vedenalainen"] is True
    assert feature["cityName"] == "Tampere"
    assert feature["geom"].startswith("MULTIPOINT")
    assert feature["table"] == "museovirastoarcrest_muinaisjaannokset"


def test_get_rkykohteet_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][1])
    assert feature["ID"]
    assert feature["name"] == "Pyynikin näkötorni"
    assert feature["geom"].startswith("MULTIPOINT")
    assert feature["table"] == "museovirastoarcrest_rkykohteet"


def test_get_naturasac_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][2])
    assert feature["naturaTunnus"]
    assert feature["name"] == "Siikaneva"
    assert feature["geom"].startswith("MULTIPOLYGON")
    assert feature["table"] == "syke_natura2000"


def test_get_naturaspa_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][3])
    assert feature["naturaTunnus"]
    assert feature["name"] == "Kaakkurijärvet"
    assert feature["geom"].startswith("MULTIPOLYGON")
    assert feature["table"] == "syke_natura2000"


def test_get_naturasci_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][4])
    assert feature["naturaTunnus"]
    assert feature["name"] == "Tulliniemen linnustonsuojelualue"
    assert feature["geom"].startswith("MULTIPOLYGON")
    assert feature["table"] == "syke_natura2000"


def test_get_valtion_feature(loader, arcgis_data):
    feature = loader.get_feature(arcgis_data["features"][5])
    assert feature["LsAlueTunnus"]
    assert feature["name"] == "Vehoniemenharjun luonnonsuojelualue"
    assert feature["infoFi"] == "Muu luonnonsuojelualue (MH)"
    assert feature["geom"].startswith("MULTIPOLYGON")
    assert feature["table"] == "syke_valtionluonnonsuojelualueet"


def assert_data_is_imported(main_db_params):
    conn = psycopg2.connect(**main_db_params)
    try:
        with conn.cursor() as cur:
            cur.execute(
                f"SELECT count(*) FROM kooste.museovirastoarcrest_muinaisjaannokset WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
            cur.execute(
                f"SELECT count(*) FROM kooste.museovirastoarcrest_rkykohteet WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
            cur.execute(
                f"SELECT mjtunnus FROM kooste.museovirastoarcrest_muinaisjaannokset"
            )
            assert cur.fetchone()[0] == 2133
            cur.execute(f'SELECT "OBJECTID" FROM kooste.museovirastoarcrest_rkykohteet')
            assert cur.fetchone()[0] == 45
            cur.execute("SELECT last_modified FROM kooste.museovirastoarcrest_metadata")
            assert cur.fetchone()[0].timestamp() == pytest.approx(
                datetime.datetime.now().timestamp(), 20
            )
            cur.execute(
                f"SELECT count(*) FROM kooste.syke_natura2000 WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 3
            cur.execute(
                f"SELECT count(*) FROM kooste.syke_valtionluonnonsuojelualueet WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
            cur.execute(f'SELECT "naturaTunnus" FROM kooste.syke_natura2000')
            results = cur.fetchone()[0] == "FI0341008"
            cur.execute(
                f'SELECT "LsAlueTunnus" FROM kooste.syke_valtionluonnonsuojelualueet'
            )
            assert cur.fetchone()[0] == "ESA040011"
            cur.execute("SELECT last_modified FROM kooste.syke_metadata")
            assert cur.fetchone()[0].timestamp() == pytest.approx(
                datetime.datetime.now().timestamp(), 20
            )
    finally:
        conn.close()


def assert_changed_data_is_imported(main_db_params):
    conn = psycopg2.connect(**main_db_params)
    try:
        with conn.cursor() as cur:
            cur.execute(
                f"SELECT count(*) FROM kooste.museovirastoarcrest_muinaisjaannokset WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
            cur.execute(
                f"SELECT count(*) FROM kooste.museovirastoarcrest_rkykohteet WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
            cur.execute(
                f"SELECT count(*) FROM kooste.syke_natura2000 WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 2
            cur.execute(
                f"SELECT count(*) FROM kooste.syke_valtionluonnonsuojelualueet WHERE NOT deleted"
            )
            assert cur.fetchone()[0] == 1
    finally:
        conn.close()


def test_save_arcgis_features(loader, arcgis_data, main_db_params):
    loader.save_features(arcgis_data["features"])
    assert_data_is_imported(main_db_params)


# a new loader should delete one natura area
def test_delete_arcgis_features(changed_arcgis_data, connection_string, main_db_params):
    assert_data_is_imported(main_db_params)
    loader = ArcGisLoader(
        connection_string,
        url={
            "museovirastoarcrest_metadata": "http://mock.url/arcgis/rest/services",
            "syke_metadata": "http://anothermock.url/arcgis/rest/services",
        },
    )
    loader.save_features(changed_arcgis_data["features"])
    assert_changed_data_is_imported(main_db_params)


# a new loader should undelete the same
def test_reinstate_arcgis_features(arcgis_data, connection_string, main_db_params):
    assert_changed_data_is_imported(main_db_params)
    loader = ArcGisLoader(
        connection_string,
        url={
            "museovirastoarcrest_metadata": "http://mock.url/arcgis/rest/services",
            "syke_metadata": "http://anothermock.url/arcgis/rest/services",
        },
    )
    loader.save_features(arcgis_data["features"])
    assert_data_is_imported(main_db_params)
